{"ast":null,"code":"/* Copyright (c) 2016, BOXEVER Ltd. info@boxever.com\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies, unless\n * agreed otherwise.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n *\n * Date: 2018-09-19T07:43Z\n */\n//Note: To reduce load times, this script will be cached by the client for a\n//period of one hour. ETag-based versioning will also be used.\n\n/*\n    json2.js\n    2011-10-19\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    See http://www.__JSON.org/js.html\n\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n\n\n    This file creates a global __JSON object containing two methods: stringify\n    and parse.\n\n        __JSON.stringify(value, replacer, space)\n            value       any JavaScript value, usually an object or array.\n\n            replacer    an optional parameter that determines how object\n                        values are stringified for objects. It can be a\n                        function or an array of strings.\n\n            space       an optional parameter that specifies the indentation\n                        of nested structures. If it is omitted, the text will\n                        be packed without extra whitespace. If it is a number,\n                        it will specify the number of spaces to indent at each\n                        level. If it is a string (such as '\\t' or '&nbsp;'),\n                        it contains the characters used to indent at each level.\n\n            This method produces a __JSON text from a JavaScript value.\n\n            When an object value is found, if the object contains a to__JSON\n            method, its to__JSON method will be called and the result will be\n            stringified. A to__JSON method does not serialize: it returns the\n            value represented by the name/value pair that should be serialized,\n            or undefined if nothing should be serialized. The to__JSON method\n            will be passed the key associated with the value, and this will be\n            bound to the value\n\n            For example, this would serialize Dates as ISO strings.\n\n                Date.prototype.to__JSON = function (key) {\n                    function f(n) {\n                        // Format integers to have at least two digits.\n                        return n < 10 ? '0' + n : n;\n                    }\n\n                    return this.getUTCFullYear()   + '-' +\n                         f(this.getUTCMonth() + 1) + '-' +\n                         f(this.getUTCDate())      + 'T' +\n                         f(this.getUTCHours())     + ':' +\n                         f(this.getUTCMinutes())   + ':' +\n                         f(this.getUTCSeconds())   + 'Z';\n                };\n\n            You can provide an optional replacer method. It will be passed the\n            key and value of each member, with this bound to the containing\n            object. The value that is returned from your method will be\n            serialized. If your method returns undefined, then the member will\n            be excluded from the serialization.\n\n            If the replacer parameter is an array of strings, then it will be\n            used to select the members to be serialized. It filters the results\n            such that only members with keys listed in the replacer array are\n            stringified.\n\n            Values that do not have __JSON representations, such as undefined or\n            functions, will not be serialized. Such values in objects will be\n            dropped; in arrays they will be replaced with null. You can use\n            a replacer function to replace those with __JSON values.\n            __JSON.stringify(undefined) returns undefined.\n\n            The optional space parameter produces a stringification of the\n            value that is filled with line breaks and indentation to make it\n            easier to read.\n\n            If the space parameter is a non-empty string, then that string will\n            be used for indentation. If the space parameter is a number, then\n            the indentation will be that many spaces.\n\n            Example:\n\n            text = __JSON.stringify(['e', {pluribus: 'unum'}]);\n            // text is '[\"e\",{\"pluribus\":\"unum\"}]'\n\n\n            text = __JSON.stringify(['e', {pluribus: 'unum'}], null, '\\t');\n            // text is '[\\n\\t\"e\",\\n\\t{\\n\\t\\t\"pluribus\": \"unum\"\\n\\t}\\n]'\n\n            text = __JSON.stringify([new Date()], function (key, value) {\n                return this[key] instanceof Date ?\n                    'Date(' + this[key] + ')' : value;\n            });\n            // text is '[\"Date(---current time---)\"]'\n\n\n        __JSON.parse(text, reviver)\n            This method parses a __JSON text to produce an object or array.\n            It can throw a SyntaxError exception.\n\n            The optional reviver parameter is a function that can filter and\n            transform the results. It receives each of the keys and values,\n            and its return value is used instead of the original value.\n            If it returns what it received, then the structure is not modified.\n            If it returns undefined then the member is deleted.\n\n            Example:\n\n            // Parse the text. Values that look like ISO date strings will\n            // be converted to Date objects.\n\n            myData = __JSON.parse(text, function (key, value) {\n                var a;\n                if (typeof value === 'string') {\n                    a =\n/^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)Z$/.exec(value);\n                    if (a) {\n                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],\n                            +a[5], +a[6]));\n                    }\n                }\n                return value;\n            });\n\n            myData = __JSON.parse('[\"Date(09/09/2001)\"]', function (key, value) {\n                var d;\n                if (typeof value === 'string' &&\n                        value.slice(0, 5) === 'Date(' &&\n                        value.slice(-1) === ')') {\n                    d = new Date(value.slice(5, -1));\n                    if (d) {\n                        return d;\n                    }\n                }\n                return value;\n            });\n\n\n    This is a reference implementation. You are free to copy, modify, or\n    redistribute.\n*/\n\n/*jslint evil: true, regexp: true */\n\n/*members \"\", \"\\b\", \"\\t\", \"\\n\", \"\\f\", \"\\r\", \"\\\"\", __JSON, \"\\\\\", apply,\n    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,\n    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,\n    lastIndex, length, parse, prototype, push, replace, slice, stringify,\n    test, to__JSON, toString, valueOf\n*/\n// Create a __JSON object only if one does not already exist. We create the\n// methods in a closure to avoid creating global variables.\nvar __JSON;\n\nif (!__JSON) {\n  __JSON = {};\n}\n\n(function () {\n  'use strict';\n\n  function f(n) {\n    // Format integers to have at least two digits.\n    return n < 10 ? '0' + n : n;\n  }\n\n  if (typeof Date.prototype.to__JSON !== 'function') {\n    Date.prototype.to__JSON = function (key) {\n      return isFinite(this.valueOf()) ? this.getUTCFullYear() + '-' + f(this.getUTCMonth() + 1) + '-' + f(this.getUTCDate()) + 'T' + f(this.getUTCHours()) + ':' + f(this.getUTCMinutes()) + ':' + f(this.getUTCSeconds()) + 'Z' : null;\n    };\n\n    String.prototype.to__JSON = Number.prototype.to__JSON = Boolean.prototype.to__JSON = function (key) {\n      return this.valueOf();\n    };\n  }\n\n  var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n      escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n      gap,\n      indent,\n      meta = {\n    // table of character substitutions\n    '\\b': '\\\\b',\n    '\\t': '\\\\t',\n    '\\n': '\\\\n',\n    '\\f': '\\\\f',\n    '\\r': '\\\\r',\n    '\"': '\\\\\"',\n    '\\\\': '\\\\\\\\'\n  },\n      rep;\n\n  function quote(string) {\n    // If the string contains no control characters, no quote characters, and no\n    // backslash characters, then we can safely slap some quotes around it.\n    // Otherwise we must also replace the offending characters with safe escape\n    // sequences.\n    escapable.lastIndex = 0;\n    return escapable.test(string) ? '\"' + string.replace(escapable, function (a) {\n      var c = meta[a];\n      return typeof c === 'string' ? c : \"\\\\u\" + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n    }) + '\"' : '\"' + string + '\"';\n  }\n\n  function str(key, holder) {\n    // Produce a string from holder[key].\n    var i,\n        // The loop counter.\n    k,\n        // The member key.\n    v,\n        // The member value.\n    length,\n        mind = gap,\n        partial,\n        value = holder[key]; // If the value has a to__JSON method, call it to obtain a replacement value.\n\n    if (value && typeof value === 'object' && typeof value.to__JSON === 'function') {\n      value = value.to__JSON(key);\n    } // If we were called with a replacer function, then call the replacer to\n    // obtain a replacement value.\n\n\n    if (typeof rep === 'function') {\n      value = rep.call(holder, key, value);\n    } // What happens next depends on the value's type.\n\n\n    switch (typeof value) {\n      case 'string':\n        return quote(value);\n\n      case 'number':\n        // __JSON numbers must be finite. Encode non-finite numbers as null.\n        return isFinite(value) ? String(value) : 'null';\n\n      case 'boolean':\n      case 'null':\n        // If the value is a boolean or null, convert it to a string. Note:\n        // typeof null does not produce 'null'. The case is included here in\n        // the remote chance that this gets fixed someday.\n        return String(value);\n      // If the type is 'object', we might be dealing with an object or an array or\n      // null.\n\n      case 'object':\n        // Due to a specification blunder in ECMAScript, typeof null is 'object',\n        // so watch out for that case.\n        if (!value) {\n          return 'null';\n        } // Make an array to hold the partial results of stringifying this object value.\n\n\n        gap += indent;\n        partial = []; // Is the value an array?\n\n        if (Object.prototype.toString.apply(value) === '[object Array]') {\n          // The value is an array. Stringify every element. Use null as a placeholder\n          // for non-__JSON values.\n          length = value.length;\n\n          for (i = 0; i < length; i += 1) {\n            partial[i] = str(i, value) || 'null';\n          } // Join all of the elements together, separated with commas, and wrap them in\n          // brackets.\n\n\n          v = partial.length === 0 ? '[]' : gap ? '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']' : '[' + partial.join(',') + ']';\n          gap = mind;\n          return v;\n        } // If the replacer is an array, use it to select the members to be stringified.\n\n\n        if (rep && typeof rep === 'object') {\n          length = rep.length;\n\n          for (i = 0; i < length; i += 1) {\n            if (typeof rep[i] === 'string') {\n              k = rep[i];\n              v = str(k, value);\n\n              if (v) {\n                partial.push(quote(k) + (gap ? ': ' : ':') + v);\n              }\n            }\n          }\n        } else {\n          // Otherwise, iterate through all of the keys in the object.\n          for (k in value) {\n            if (Object.prototype.hasOwnProperty.call(value, k)) {\n              v = str(k, value);\n\n              if (v) {\n                partial.push(quote(k) + (gap ? ': ' : ':') + v);\n              }\n            }\n          }\n        } // Join all of the member texts together, separated with commas,\n        // and wrap them in braces.\n\n\n        v = partial.length === 0 ? '{}' : gap ? '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + '}' : '{' + partial.join(',') + '}';\n        gap = mind;\n        return v;\n    }\n  } // If the __JSON object does not yet have a stringify method, give it one.\n\n\n  if (typeof __JSON.stringify !== 'function') {\n    __JSON.stringify = function (value, replacer, space) {\n      // The stringify method takes a value and an optional replacer, and an optional\n      // space parameter, and returns a __JSON text. The replacer can be a function\n      // that can replace values, or an array of strings that will select the keys.\n      // A default replacer method can be provided. Use of the space parameter can\n      // produce text that is more easily readable.\n      var i;\n      gap = '';\n      indent = ''; // If the space parameter is a number, make an indent string containing that\n      // many spaces.\n\n      if (typeof space === 'number') {\n        for (i = 0; i < space; i += 1) {\n          indent += ' ';\n        } // If the space parameter is a string, it will be used as the indent string.\n\n      } else if (typeof space === 'string') {\n        indent = space;\n      } // If there is a replacer, it must be a function or an array.\n      // Otherwise, throw an error.\n\n\n      rep = replacer;\n\n      if (replacer && typeof replacer !== 'function' && (typeof replacer !== 'object' || typeof replacer.length !== 'number')) {\n        throw new Error('__JSON.stringify');\n      } // Make a fake root object containing our value under the key of ''.\n      // Return the result of stringifying the value.\n\n\n      return str('', {\n        '': value\n      });\n    };\n  } // If the __JSON object does not yet have a parse method, give it one.\n\n\n  if (typeof __JSON.parse !== 'function') {\n    __JSON.parse = function (text, reviver) {\n      // The parse method takes a text and an optional reviver function, and returns\n      // a JavaScript value if the text is a valid __JSON text.\n      var j;\n\n      function walk(holder, key) {\n        // The walk method is used to recursively walk the resulting structure so\n        // that modifications can be made.\n        var k,\n            v,\n            value = holder[key];\n\n        if (value && typeof value === 'object') {\n          for (k in value) {\n            if (Object.prototype.hasOwnProperty.call(value, k)) {\n              v = walk(value, k);\n\n              if (v !== undefined) {\n                value[k] = v;\n              } else {\n                delete value[k];\n              }\n            }\n          }\n        }\n\n        return reviver.call(holder, key, value);\n      } // Parsing happens in four stages. In the first stage, we replace certain\n      // Unicode characters with escape sequences. JavaScript handles many characters\n      // incorrectly, either silently deleting them, or treating them as line endings.\n\n\n      text = String(text);\n      cx.lastIndex = 0;\n\n      if (cx.test(text)) {\n        text = text.replace(cx, function (a) {\n          return \"\\\\u\" + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n        });\n      } // In the second stage, we run the text against regular expressions that look\n      // for non-__JSON patterns. We are especially concerned with '()' and 'new'\n      // because they can cause invocation, and '=' because it can cause mutation.\n      // But just to be safe, we want to reject all unexpected forms.\n      // We split the second stage into 4 regexp operations in order to work around\n      // crippling inefficiencies in IE's and Safari's regexp engines. First we\n      // replace the __JSON backslash pairs with '@' (a non-__JSON character). Second, we\n      // replace all simple value tokens with ']' characters. Third, we delete all\n      // open brackets that follow a colon or comma or that begin the text. Finally,\n      // we look to see that the remaining characters are only whitespace or ']' or\n      // ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\n\n      if (/^[\\],:{}\\s]*$/.test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\n        // In the third stage we use the eval function to compile the text into a\n        // JavaScript structure. The '{' operator is subject to a syntactic ambiguity\n        // in JavaScript: it can begin a block or an object literal. We wrap the text\n        // in parens to eliminate the ambiguity.\n        j = eval('(' + text + ')'); // In the optional fourth stage, we recursively walk the new structure, passing\n        // each name/value pair to a reviver function for possible transformation.\n\n        return typeof reviver === 'function' ? walk({\n          '': j\n        }, '') : j;\n      } // If the text is not __JSON parseable, then a SyntaxError is thrown.\n\n\n      throw new SyntaxError('__JSON.parse');\n    };\n  }\n})();\n/*\n * ----------------------------- JSTORAGE -------------------------------------\n * Simple local storage wrapper to save data on the browser side, supporting\n * all major browsers - IE6+, Firefox2+, Safari4+, Chrome4+ and Opera 10.5+\n *\n * Copyright (c) 2010 - 2012 Andris Reinman, andris.reinman@gmail.com\n * Project homepage: www.jstorage.info\n *\n * Licensed under MIT-style license:\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n\nvar BoxeverStorage = BoxeverStorage || {};\n\n(function () {\n  var\n  /* bStorage version */\n  BSTORAGE_VERSION = \"0.4.3\",\n\n  /* detect a dollar object or create one if not found */\n  $ = window.jQuery || window.$ || (window.$ = {}),\n\n  /* check for a JSON handling support */\n  JSON = {\n    parse: window.JSON && (window.JSON.parse || window.JSON.decode) || window.__JSON && window.__JSON.parse || __JSON && __JSON.parse || String.prototype.evalJSON && function (str) {\n      return String(str).evalJSON();\n    } || $.parseJSON || $.evalJSON,\n    stringify: Object.toJSON || window.JSON && (window.JSON.stringify || window.JSON.encode) || window.__JSON && window.__JSON.stringify || __JSON && __JSON.stringify || $.toJSON\n  }; // Break if no JSON support was found\n\n  if (!JSON.parse || !JSON.stringify) {\n    throw new Error(\"No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page\");\n  }\n\n  var\n  /* This is the object, that holds the cached values */\n  _storage = {\n    __bstorage_meta: {\n      CRC32: {}\n    }\n  },\n\n  /* Actual browser storage (localStorage or globalStorage['domain']) */\n  _storage_service = {\n    bStorage: \"{}\"\n  },\n\n  /* DOM element for older IE versions, holds userData behavior */\n  _storage_elm = null,\n\n  /* How much space does the storage take */\n  _storage_size = 0,\n\n  /* which backend is currently used */\n  _backend = false,\n\n  /* onchange observers */\n  _observers = {},\n\n  /* timeout to wait after onchange event */\n  _observer_timeout = false,\n\n  /* last update time */\n  _observer_update = 0,\n\n  /* pubsub observers */\n  _pubsub_observers = {},\n\n  /* skip published items older than current timestamp */\n  _pubsub_last = +new Date(),\n\n  /* Next check for TTL */\n  _ttl_timeout,\n\n  /**\n   * XML encoding and decoding as XML nodes can't be JSON'ized\n   * XML nodes are encoded and decoded if the node is the value to be saved\n   * but not if it's as a property of another object\n   * Eg. -\n   *   $.bStorage.set(\"key\", xmlNode);        // IS OK\n   *   $.bStorage.set(\"key\", {xml: xmlNode}); // NOT OK\n   */\n  _XMLService = {\n    /**\n     * Validates a XML node to be XML\n     * based on jQuery.isXML function\n     */\n    isXML: function isXML(elm) {\n      var documentElement = (elm ? elm.ownerDocument || elm : 0).documentElement;\n      return documentElement ? documentElement.nodeName !== \"HTML\" : false;\n    },\n\n    /**\n     * Encodes a XML node to string\n     * based on http://www.mercurytide.co.uk/news/article/issues-when-working-ajax/\n     */\n    encode: function encode(xmlNode) {\n      if (!this.isXML(xmlNode)) {\n        return false;\n      }\n\n      try {\n        // Mozilla, Webkit, Opera\n        return new XMLSerializer().serializeToString(xmlNode);\n      } catch (E1) {\n        try {\n          // IE\n          return xmlNode.xml;\n        } catch (E2) {}\n      }\n\n      return false;\n    }\n    /**\n     * Decodes a XML node from string\n     * loosely based on http://outwestmedia.com/jquery-plugins/xmldom/\n     */\n    // decode: function(xmlString){\n    //     var dom_parser = (\"DOMParser\" in window && (new DOMParser()).parseFromString) ||\n    //             (window.ActiveXObject && function(_xmlString) {\n    //         var xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n    //         xml_doc.async = 'false';\n    //         xml_doc.loadXML(_xmlString);\n    //         return xml_doc;\n    //     }),\n    //     resultXML;\n    //     if(!dom_parser){\n    //         return false;\n    //     }\n    //     resultXML = dom_parser.call(\"DOMParser\" in window && (new DOMParser()) || window, xmlString, 'text/xml');\n    //     return this.isXML(resultXML)?resultXML:false;\n    // }\n\n  }; ////////////////////////// PRIVATE METHODS ////////////////////////\n\n  /**\n   * Initialization function. Detects if the browser supports DOM Storage\n   * or userData behavior and behaves accordingly.\n   */\n\n\n  function _init() {\n    /* Check if browser supports localStorage */\n    var localStorageReallyWorks = false;\n\n    if (\"localStorage\" in window) {\n      try {\n        window.localStorage.setItem('_tmptest', 'tmpval');\n        localStorageReallyWorks = true;\n        window.localStorage.removeItem('_tmptest');\n      } catch (BogusQuotaExceededErrorOnIos5) {// Thanks be to iOS5 Private Browsing mode which throws\n        // QUOTA_EXCEEDED_ERRROR DOM Exception 22.\n      }\n    }\n\n    if (localStorageReallyWorks) {\n      try {\n        if (window.localStorage) {\n          _storage_service = window.localStorage;\n          _backend = \"localStorage\";\n          _observer_update = _storage_service.bStorage_update;\n        }\n      } catch (E3) {\n        /* Firefox fails when touching localStorage and cookies are disabled */\n      }\n    }\n    /* Check if browser supports globalStorage */\n    else if (\"globalStorage\" in window) {\n        try {\n          if (window.globalStorage) {\n            if (window.location.hostname == 'localhost') {\n              _storage_service = window.globalStorage['localhost.localdomain'];\n            } else {\n              _storage_service = window.globalStorage[window.location.hostname];\n            }\n\n            _backend = \"globalStorage\";\n            _observer_update = _storage_service.bStorage_update;\n          }\n        } catch (E4) {\n          /* Firefox fails when touching localStorage and cookies are disabled */\n        }\n      }\n      /* Check if browser supports userData behavior */\n      else {\n          _storage_elm = document.createElement('link');\n\n          if (_storage_elm.addBehavior) {\n            /* Use a DOM element to act as userData storage */\n            _storage_elm.style.behavior = 'url(#default#userData)';\n            /* userData element needs to be inserted into the DOM! */\n\n            document.getElementsByTagName('head')[0].appendChild(_storage_elm);\n\n            try {\n              _storage_elm.load(\"bStorage\");\n            } catch (E) {\n              // try to reset cache\n              _storage_elm.setAttribute(\"bStorage\", \"{}\");\n\n              _storage_elm.save(\"bStorage\");\n\n              _storage_elm.load(\"bStorage\");\n            }\n\n            var data = \"{}\";\n\n            try {\n              data = _storage_elm.getAttribute(\"bStorage\");\n            } catch (E5) {}\n\n            try {\n              _observer_update = _storage_elm.getAttribute(\"bStorage_update\");\n            } catch (E6) {}\n\n            _storage_service.bStorage = data;\n            _backend = \"userDataBehavior\";\n          } else {\n            _storage_elm = null;\n            return;\n          }\n        } // Load data from storage\n\n\n    _load_storage(); // remove dead keys\n\n\n    _handleTTL(); // start listening for changes\n\n\n    _setupObserver(); // initialize publish-subscribe service\n\n\n    _handlePubSub(); // handle cached navigation\n\n\n    if (\"addEventListener\" in window) {\n      window.addEventListener(\"pageshow\", function (event) {\n        if (event.persisted) {\n          _storageObserver();\n        }\n      }, false);\n    }\n  }\n  /**\n   * Reload data from storage when needed\n   */\n\n\n  function _reloadData() {\n    var data = \"{}\";\n\n    if (_backend == \"userDataBehavior\") {\n      _storage_elm.load(\"bStorage\");\n\n      try {\n        data = _storage_elm.getAttribute(\"bStorage\");\n      } catch (E5) {}\n\n      try {\n        _observer_update = _storage_elm.getAttribute(\"bStorage_update\");\n      } catch (E6) {}\n\n      _storage_service.bStorage = data;\n    }\n\n    _load_storage(); // remove dead keys\n\n\n    _handleTTL();\n\n    _handlePubSub();\n  }\n  /**\n   * Sets up a storage change observer\n   */\n\n\n  function _setupObserver() {\n    if (_backend == \"localStorage\" || _backend == \"globalStorage\") {\n      if (\"addEventListener\" in window) {\n        window.addEventListener(\"storage\", _storageObserver, false);\n      } else {\n        document.attachEvent(\"onstorage\", _storageObserver);\n      }\n    } else if (_backend == \"userDataBehavior\") {\n      setInterval(_storageObserver, 1000);\n    }\n  }\n  /**\n   * Fired on any kind of data change, needs to check if anything has\n   * really been changed\n   */\n\n\n  function _storageObserver() {\n    var updateTime; // cumulate change notifications with timeout\n\n    clearTimeout(_observer_timeout);\n    _observer_timeout = setTimeout(function () {\n      if (_backend == \"localStorage\" || _backend == \"globalStorage\") {\n        updateTime = _storage_service.bStorage_update;\n      } else if (_backend == \"userDataBehavior\") {\n        _storage_elm.load(\"bStorage\");\n\n        try {\n          updateTime = _storage_elm.getAttribute(\"bStorage_update\");\n        } catch (E5) {}\n      }\n\n      if (updateTime && updateTime != _observer_update) {\n        _observer_update = updateTime;\n\n        _checkUpdatedKeys();\n      }\n    }, 25);\n  }\n  /**\n   * Reloads the data and checks if any keys are changed\n   */\n\n\n  function _checkUpdatedKeys() {\n    var oldCrc32List = JSON.parse(JSON.stringify(_storage.__bstorage_meta.CRC32)),\n        newCrc32List;\n\n    _reloadData();\n\n    newCrc32List = JSON.parse(JSON.stringify(_storage.__bstorage_meta.CRC32));\n    var key,\n        updated = [],\n        removed = [];\n\n    for (key in oldCrc32List) {\n      if (oldCrc32List.hasOwnProperty(key)) {\n        if (!newCrc32List[key]) {\n          removed.push(key);\n          continue;\n        }\n\n        if (oldCrc32List[key] != newCrc32List[key] && String(oldCrc32List[key]).substr(0, 2) == \"2.\") {\n          updated.push(key);\n        }\n      }\n    }\n\n    for (key in newCrc32List) {\n      if (newCrc32List.hasOwnProperty(key)) {\n        if (!oldCrc32List[key]) {\n          updated.push(key);\n        }\n      }\n    }\n\n    _fireObservers(updated, \"updated\");\n\n    _fireObservers(removed, \"deleted\");\n  }\n  /**\n   * Fires observers for updated keys\n   *\n   * @param {Array|String} keys Array of key names or a key\n   * @param {String} action What happened with the value (updated, deleted, flushed)\n   */\n\n\n  function _fireObservers(keys, action) {\n    keys = [].concat(keys || []);\n\n    if (action == \"flushed\") {\n      keys = [];\n\n      for (var key in _observers) {\n        if (_observers.hasOwnProperty(key)) {\n          keys.push(key);\n        }\n      }\n\n      action = \"deleted\";\n    }\n\n    for (var i = 0, len = keys.length; i < len; i++) {\n      if (_observers[keys[i]]) {\n        for (var j = 0, jlen = _observers[keys[i]].length; j < jlen; j++) {\n          _observers[keys[i]][j](keys[i], action);\n        }\n      }\n\n      if (_observers[\"*\"]) {\n        for (var j = 0, jlen = _observers[\"*\"].length; j < jlen; j++) {\n          _observers[\"*\"][j](keys[i], action);\n        }\n      }\n    }\n  }\n  /**\n   * Publishes key change to listeners\n   */\n\n\n  function _publishChange() {\n    var updateTime = (+new Date()).toString();\n\n    if (_backend == \"localStorage\" || _backend == \"globalStorage\") {\n      _storage_service.bStorage_update = updateTime;\n    } else if (_backend == \"userDataBehavior\") {\n      _storage_elm.setAttribute(\"bStorage_update\", updateTime);\n\n      _storage_elm.save(\"bStorage\");\n    }\n\n    _storageObserver();\n  }\n  /**\n   * Loads the data from the storage based on the supported mechanism\n   */\n\n\n  function _load_storage() {\n    /* if bStorage string is retrieved, then decode it */\n    if (_storage_service.bStorage) {\n      try {\n        _storage = JSON.parse(String(_storage_service.bStorage));\n      } catch (E6) {\n        _storage_service.bStorage = \"{}\";\n      }\n    } else {\n      _storage_service.bStorage = \"{}\";\n    }\n\n    _storage_size = _storage_service.bStorage ? String(_storage_service.bStorage).length : 0;\n\n    if (!_storage.__bstorage_meta) {\n      _storage.__bstorage_meta = {};\n    }\n\n    if (!_storage.__bstorage_meta.CRC32) {\n      _storage.__bstorage_meta.CRC32 = {};\n    }\n  }\n  /**\n   * This functions provides the \"save\" mechanism to store the bStorage object\n   */\n\n\n  function _save() {\n    _dropOldEvents(); // remove expired events\n\n\n    try {\n      _storage_service.bStorage = JSON.stringify(_storage); // If userData is used as the storage engine, additional\n\n      if (_storage_elm) {\n        _storage_elm.setAttribute(\"bStorage\", _storage_service.bStorage);\n\n        _storage_elm.save(\"bStorage\");\n      }\n\n      _storage_size = _storage_service.bStorage ? String(_storage_service.bStorage).length : 0;\n    } catch (E7) {\n      /* probably cache is full, nothing is saved this way*/\n    }\n  }\n  /**\n   * Function checks if a key is set and is string or numberic\n   *\n   * @param {String} key Key name\n   */\n\n\n  function _checkKey(key) {\n    if (!key || typeof key != \"string\" && typeof key != \"number\") {\n      throw new TypeError('Key name must be string or numeric');\n    }\n\n    if (key == \"__bstorage_meta\") {\n      throw new TypeError('Reserved key name');\n    }\n\n    return true;\n  }\n  /**\n   * Removes expired keys\n   */\n\n\n  function _handleTTL() {\n    var curtime,\n        i,\n        TTL,\n        CRC32,\n        nextExpire = Infinity,\n        changed = false,\n        deleted = [];\n    clearTimeout(_ttl_timeout);\n\n    if (!_storage.__bstorage_meta || typeof _storage.__bstorage_meta.TTL != \"object\") {\n      // nothing to do here\n      return;\n    }\n\n    curtime = +new Date();\n    TTL = _storage.__bstorage_meta.TTL;\n    CRC32 = _storage.__bstorage_meta.CRC32;\n\n    for (i in TTL) {\n      if (TTL.hasOwnProperty(i)) {\n        if (TTL[i] <= curtime) {\n          delete TTL[i];\n          delete CRC32[i];\n          delete _storage[i];\n          changed = true;\n          deleted.push(i);\n        } else if (TTL[i] < nextExpire) {\n          nextExpire = TTL[i];\n        }\n      }\n    } // set next check\n\n\n    if (nextExpire != Infinity) {\n      _ttl_timeout = setTimeout(_handleTTL, nextExpire - curtime);\n    } // save changes\n\n\n    if (changed) {\n      _save();\n\n      _publishChange();\n\n      _fireObservers(deleted, \"deleted\");\n    }\n  }\n  /**\n   * Checks if there's any events on hold to be fired to listeners\n   */\n\n\n  function _handlePubSub() {\n    var i, len;\n\n    if (!_storage.__bstorage_meta.PubSub) {\n      return;\n    }\n\n    var pubelm,\n        _pubsubCurrent = _pubsub_last;\n\n    for (i = len = _storage.__bstorage_meta.PubSub.length - 1; i >= 0; i--) {\n      pubelm = _storage.__bstorage_meta.PubSub[i];\n\n      if (pubelm[0] > _pubsub_last) {\n        _pubsubCurrent = pubelm[0];\n\n        _fireSubscribers(pubelm[1], pubelm[2]);\n      }\n    }\n\n    _pubsub_last = _pubsubCurrent;\n  }\n  /**\n   * Fires all subscriber listeners for a pubsub channel\n   *\n   * @param {String} channel Channel name\n   * @param {Mixed} payload Payload data to deliver\n   */\n\n\n  function _fireSubscribers(channel, payload) {\n    if (_pubsub_observers[channel]) {\n      for (var i = 0, len = _pubsub_observers[channel].length; i < len; i++) {\n        // send immutable data that can't be modified by listeners\n        _pubsub_observers[channel][i](channel, JSON.parse(JSON.stringify(payload)));\n      }\n    }\n  }\n  /**\n   * Remove old events from the publish stream (at least 2sec old)\n   */\n\n\n  function _dropOldEvents() {\n    if (!_storage.__bstorage_meta.PubSub) {\n      return;\n    }\n\n    var retire = +new Date() - 2000;\n\n    for (var i = 0, len = _storage.__bstorage_meta.PubSub.length; i < len; i++) {\n      if (_storage.__bstorage_meta.PubSub[i][0] <= retire) {\n        // deleteCount is needed for IE6\n        _storage.__bstorage_meta.PubSub.splice(i, _storage.__bstorage_meta.PubSub.length - i);\n\n        break;\n      }\n    }\n\n    if (!_storage.__bstorage_meta.PubSub.length) {\n      delete _storage.__bstorage_meta.PubSub;\n    }\n  }\n  /**\n   * Publish payload to a channel\n   *\n   * @param {String} channel Channel name\n   * @param {Mixed} payload Payload to send to the subscribers\n   */\n\n\n  function _publish(channel, payload) {\n    if (!_storage.__bstorage_meta) {\n      _storage.__bstorage_meta = {};\n    }\n\n    if (!_storage.__bstorage_meta.PubSub) {\n      _storage.__bstorage_meta.PubSub = [];\n    }\n\n    _storage.__bstorage_meta.PubSub.unshift([+new Date(), channel, payload]);\n\n    _save();\n\n    _publishChange();\n  }\n  /**\n   * JS Implementation of MurmurHash2\n   *\n   *  SOURCE: https://github.com/garycourt/murmurhash-js (MIT licensed)\n   *\n   * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n   * @see http://github.com/garycourt/murmurhash-js\n   * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n   * @see http://sites.google.com/site/murmurhash/\n   *\n   * @param {string} str ASCII only\n   * @param {number} seed Positive integer only\n   * @return {number} 32-bit positive integer hash\n   */\n\n\n  function murmurhash2_32_gc(str, seed) {\n    var l = str.length,\n        h = seed ^ l,\n        i = 0,\n        k;\n\n    while (l >= 4) {\n      k = str.charCodeAt(i) & 0xff | (str.charCodeAt(++i) & 0xff) << 8 | (str.charCodeAt(++i) & 0xff) << 16 | (str.charCodeAt(++i) & 0xff) << 24;\n      k = (k & 0xffff) * 0x5bd1e995 + (((k >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n      k ^= k >>> 24;\n      k = (k & 0xffff) * 0x5bd1e995 + (((k >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n      h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16) ^ k;\n      l -= 4;\n      ++i;\n    }\n\n    switch (l) {\n      case 3:\n        h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n\n      case 2:\n        h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n\n      case 1:\n        h ^= str.charCodeAt(i) & 0xff;\n        h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n    }\n\n    h ^= h >>> 13;\n    h = (h & 0xffff) * 0x5bd1e995 + (((h >>> 16) * 0x5bd1e995 & 0xffff) << 16);\n    h ^= h >>> 15;\n    return h >>> 0;\n  } ////////////////////////// PUBLIC INTERFACE /////////////////////////\n\n\n  BoxeverStorage = {\n    /* Version number */\n    version: BSTORAGE_VERSION,\n\n    /**\n     * Sets a key's value.\n     *\n     * @param {String} key Key to set. If this value is not set or not\n     *              a string an exception is raised.\n     * @param {Mixed} value Value to set. This can be any value that is JSON\n     *              compatible (Numbers, Strings, Objects etc.).\n     * @param {Object} [options] - possible options to use\n     * @param {Number} [options.TTL] - optional TTL value\n     * @return {Mixed} the used value\n     */\n    set: function set(key, value, options) {\n      _checkKey(key);\n\n      options = options || {}; // undefined values are deleted automatically\n\n      if (typeof value == \"undefined\") {\n        this.deleteKey(key);\n        return value;\n      }\n\n      if (_XMLService.isXML(value)) {\n        value = {\n          _is_xml: true,\n          xml: _XMLService.encode(value)\n        };\n      } else if (typeof value == \"function\") {\n        return undefined; // functions can't be saved!\n      } else if (value && typeof value == \"object\") {\n        // clone the object before saving to _storage tree\n        value = JSON.parse(JSON.stringify(value));\n      }\n\n      _storage[key] = value;\n      _storage.__bstorage_meta.CRC32[key] = \"2.\" + murmurhash2_32_gc(JSON.stringify(value), 0x9747b28c);\n      this.setTTL(key, options.TTL || 0); // also handles saving and _publishChange\n\n      _fireObservers(key, \"updated\");\n\n      return value;\n    },\n\n    /**\n     * Looks up a key in cache\n     *\n     * @param {String} key - Key to look up.\n     * @param {mixed} def - Default value to return, if key didn't exist.\n     * @return {Mixed} the key value, default value or null\n     */\n    get: function get(key, def) {\n      _checkKey(key);\n\n      if (key in _storage) {\n        if (_storage[key] && typeof _storage[key] == \"object\" && _storage[key]._is_xml) {\n          return _XMLService.decode(_storage[key].xml);\n        } else {\n          return _storage[key];\n        }\n      }\n\n      return typeof def == 'undefined' ? null : def;\n    },\n\n    /**\n     * Deletes a key from cache.\n     *\n     * @param {String} key - Key to delete.\n     * @return {Boolean} true if key existed or false if it didn't\n     */\n    deleteKey: function deleteKey(key) {\n      _checkKey(key);\n\n      if (key in _storage) {\n        delete _storage[key]; // remove from TTL list\n\n        if (typeof _storage.__bstorage_meta.TTL == \"object\" && key in _storage.__bstorage_meta.TTL) {\n          delete _storage.__bstorage_meta.TTL[key];\n        }\n\n        delete _storage.__bstorage_meta.CRC32[key];\n\n        _save();\n\n        _publishChange();\n\n        _fireObservers(key, \"deleted\");\n\n        return true;\n      }\n\n      return false;\n    },\n\n    /**\n     * Sets a TTL for a key, or remove it if ttl value is 0 or below\n     *\n     * @param {String} key - key to set the TTL for\n     * @param {Number} ttl - TTL timeout in milliseconds\n     * @return {Boolean} true if key existed or false if it didn't\n     */\n    setTTL: function setTTL(key, ttl) {\n      var curtime = +new Date();\n\n      _checkKey(key);\n\n      ttl = Number(ttl) || 0;\n\n      if (key in _storage) {\n        if (!_storage.__bstorage_meta.TTL) {\n          _storage.__bstorage_meta.TTL = {};\n        } // Set TTL value for the key\n\n\n        if (ttl > 0) {\n          _storage.__bstorage_meta.TTL[key] = curtime + ttl;\n        } else {\n          delete _storage.__bstorage_meta.TTL[key];\n        }\n\n        _save();\n\n        _handleTTL();\n\n        _publishChange();\n\n        return true;\n      }\n\n      return false;\n    },\n\n    /**\n     * Gets remaining TTL (in milliseconds) for a key or 0 when no TTL has been set\n     *\n     * @param {String} key Key to check\n     * @return {Number} Remaining TTL in milliseconds\n     */\n    getTTL: function getTTL(key) {\n      var curtime = +new Date(),\n          ttl;\n\n      _checkKey(key);\n\n      if (key in _storage && _storage.__bstorage_meta.TTL && _storage.__bstorage_meta.TTL[key]) {\n        ttl = _storage.__bstorage_meta.TTL[key] - curtime;\n        return ttl || 0;\n      }\n\n      return 0;\n    },\n\n    /**\n     * Deletes everything in cache.\n     *\n     * @return {Boolean} Always true\n     */\n    flush: function flush() {\n      _storage = {\n        __bstorage_meta: {\n          CRC32: {}\n        }\n      };\n\n      _save();\n\n      _publishChange();\n\n      _fireObservers(null, \"flushed\");\n\n      return true;\n    },\n\n    /**\n     * Returns a read-only copy of _storage\n     *\n     * @return {Object} Read-only copy of _storage\n    */\n    storageObj: function storageObj() {\n      function F() {}\n\n      F.prototype = _storage;\n      return new F();\n    },\n\n    /**\n     * Returns an index of all used keys as an array\n     * ['key1', 'key2',..'keyN']\n     *\n     * @return {Array} Used keys\n    */\n    index: function index() {\n      var index = [],\n          i;\n\n      for (i in _storage) {\n        if (_storage.hasOwnProperty(i) && i != \"__bstorage_meta\") {\n          index.push(i);\n        }\n      }\n\n      return index;\n    },\n\n    /**\n     * How much space in bytes does the storage take?\n     *\n     * @return {Number} Storage size in chars (not the same as in bytes,\n     *                  since some chars may take several bytes)\n     */\n    storageSize: function storageSize() {\n      return _storage_size;\n    },\n\n    /**\n     * Which backend is currently in use?\n     *\n     * @return {String} Backend name\n     */\n    currentBackend: function currentBackend() {\n      return _backend;\n    },\n\n    /**\n     * Test if storage is available\n     *\n     * @return {Boolean} True if storage can be used\n     */\n    storageAvailable: function storageAvailable() {\n      return !!_backend;\n    },\n\n    /**\n     * Register change listeners\n     *\n     * @param {String} key Key name\n     * @param {Function} callback Function to run when the key changes\n     */\n    listenKeyChange: function listenKeyChange(key, callback) {\n      _checkKey(key);\n\n      if (!_observers[key]) {\n        _observers[key] = [];\n      }\n\n      _observers[key].push(callback);\n    },\n\n    /**\n     * Remove change listeners\n     *\n     * @param {String} key Key name to unregister listeners against\n     * @param {Function} [callback] If set, unregister the callback, if not - unregister all\n     */\n    stopListening: function stopListening(key, callback) {\n      _checkKey(key);\n\n      if (!_observers[key]) {\n        return;\n      }\n\n      if (!callback) {\n        delete _observers[key];\n        return;\n      }\n\n      for (var i = _observers[key].length - 1; i >= 0; i--) {\n        if (_observers[key][i] == callback) {\n          _observers[key].splice(i, 1);\n        }\n      }\n    },\n\n    /**\n     * Subscribe to a Publish/Subscribe event stream\n     *\n     * @param {String} channel Channel name\n     * @param {Function} callback Function to run when the something is published to the channel\n     */\n    subscribe: function subscribe(channel, callback) {\n      channel = (channel || \"\").toString();\n\n      if (!channel) {\n        throw new TypeError('Channel not defined');\n      }\n\n      if (!_pubsub_observers[channel]) {\n        _pubsub_observers[channel] = [];\n      }\n\n      _pubsub_observers[channel].push(callback);\n    },\n\n    /**\n     * Publish data to an event stream\n     *\n     * @param {String} channel Channel name\n     * @param {Mixed} payload Payload to deliver\n     */\n    publish: function publish(channel, payload) {\n      channel = (channel || \"\").toString();\n\n      if (!channel) {\n        throw new TypeError('Channel not defined');\n      }\n\n      _publish(channel, payload);\n    },\n\n    /**\n     * Reloads the data from browser storage\n     */\n    reInit: function reInit() {\n      _reloadData();\n    }\n  }; // Initialize bStorage\n\n  _init();\n})();\n/*\n * ----------------------------- BoxeverXML -------------------------------------\n *\n * Dependencies: None\n */\n\n\nvar BoxeverXML = {\n  /**\n   * Validates a XML node to be XML based on jQuery.isXML function\n   *\n   * @param elem\n   *            The element to validate\n   */\n  isXML: function isXML(elem) {\n    // documentElement is verified for cases where it doesn't yet exist\n    // (such as loading iframes in IE - #4833)\n    var documentElement = (elem ? elem.ownerDocument || elem : 0).documentElement;\n    return documentElement ? documentElement.nodeName !== \"HTML\" : false;\n  },\n\n  /**\n   * Converts a string to an xml document\n   *\n   * @param str\n   *            The xml string to convert to an xml document\n   * @return the xml document\n   */\n  // string2xml : function(str) {\n  // \tif (window.ActiveXObject) {\n  // \t\tvar doc = new ActiveXObject(\"Microsoft.XMLDOM\");\n  // \t\tdoc.async = \"false\";\n  // \t\tdoc.loadXML(str);\n  // \t}\n  // \t// code for Mozilla, Firefox, Opera, etc.\n  // \telse {\n  // \t\tvar parser = new DOMParser();\n  // \t\tvar doc = parser.parseFromString(str, \"text/xml\");\n  // \t}\n  // \t// documentElement always represents the root node\n  // \treturn doc;\n  // },\n\n  /**\n   * Converts a xml document to a string\n   *\n   * @param xmlDom\n   *            The xml document to convert to a string\n   * @return the string representation of the xml document\n   */\n  xml2string: function xml2string(xmlDom) {\n    var doc = xmlDom.documentElement;\n\n    if (doc.xml == undefined) {\n      return new XMLSerializer().serializeToString(xmlDom);\n    } else {\n      return doc.xml;\n    }\n  },\n\n  /**\n   * Unescape an xml string\n   *\n   * @return the unescaped xml string\n   */\n  unescape: function unescape(str) {\n    str = str.replace(/&lt;/gi, \"<\");\n    str = str.replace(/&gt;/gi, \">\");\n    str = str.replace(/&quot;/gi, \"\\\"\");\n    str = str.replace(/&amp;/gi, \"&\");\n    return str;\n  }\n  /*\n   * ----------------------------- BoxeverJSONP -------------------------------------\n   *\n   * Dependencies: Boxever's boxever_xml.js\n   */\n\n};\nvar BoxeverJSONP = {\n  /**\n   * Generic function to make cross-domain Ajax calls (jsonp)\n   *\n   * @param rqURL\n   *            The request url\n   * @param callback\n   *            The callback function\n   */\n  exec: function exec(rqURL, callback) {\n    // Generate a callback function name\n    var callb = 'jsonp' + (Math.random() * 100).toString();\n    callb = callb.replace(/\\./g, ''); // Replace the callback=? or cb=?\n    // with the generated callback function name\n\n    rqURL = rqURL.replace('callback=?', 'callback=' + callb);\n    rqURL = rqURL.replace('cb=?', 'cb=' + callb); // Set a window variable to point to the callback function\n\n    window[callb] = function (data) {\n      try {\n        // Do some tidying up be removing the script element\n        // from the DOM once it has been executed\n        var scriptElement = document.getElementById(callb);\n        scriptElement.parentNode.removeChild(scriptElement);\n      } catch (e) {}\n\n      if (typeof data === 'string') {\n        // If data is of type string then the response is xml\n        // therefore unescape it and parse it to xml document\n        data = BoxeverXML.unescape(data);\n\n        if (window.DOMParser) {\n          var parser = new DOMParser();\n          data = parser.parseFromString(data, \"text/xml\");\n        } else {// Internet Explorer\n          // var xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n          // xmlDoc.async = false;\n          // xmlDoc.loadXML(data);\n          // data = xmlDoc;\n        }\n      } // Call the \"callback\" function\n\n\n      callback(data);\n\n      try {\n        // Do some final tidying up by setting the window variable to\n        // null and deleting the variable\n        window[callb] = null;\n        delete window[callb];\n      } catch (e) {}\n    }; // Create and amend a script element to the last position of the head\n    // tag that actually makes the request to the rqURL.\n\n\n    document.getElementsByTagName('head')[0].appendChild(function () {\n      var s = document.createElement('script');\n      s.type = 'text/javascript';\n      s.charset = 'UTF-8';\n      s.src = rqURL;\n      s.async = true;\n      s.id = callb;\n      return s;\n    }());\n  } // Define the boxever settings.\n\n};\n\nvar _boxever_settings = _boxever_settings || {};\n/*\n * ----------------------------- BoxeverJERS -------------------------------------\n * The Boxever Javascript Error Reporting Service or JERS is used to send client side\n * javascript errors to a remote server for reporting, analysing and notifications.\n *\n * Usage:\n * var BoxeverJERS = BoxeverJERS || {\"errors\" : []};\n * try {\n *     Some bad code\n * } catch(e) {\n *     BoxeverJERS.errors.push(e);\n * }\n *\n * or\n *\n * var BoxeverJERS = BoxeverJERS || {\"errors\" : []};\n * BoxeverJERS.errors.push(\"Something bad happened\");\n *\n * or\n *\n * BoxeverJERS.errors.push(function(alert(\"Something bad happened\")));\n *\n * Dependencies: Boxever's json2.js\n */\n// //////////////////////// PUBLIC VARIABLES //////////////////////\n\n\nvar BoxeverJERS = BoxeverJERS || {\n  \"errors\": []\n};\n\n(function () {\n  // //////////////////////// PRIVATE VARIABLES //////////////////////\n  var client_key;\n  var target;\n  var oldQueue = BoxeverJERS.errors; // //////////////////////// PRIVATE METHODS ////////////////////////\n\n  /**\n   * Send the error message using JSONP\n   *\n   * @param message\n   *            The message to send\n   */\n\n  function sendErrorMessage(message) {\n    var rqURL = target + '/boxever-log-js-error.js?client_key=' + client_key + '&message=' + encodeURIComponent(message); // Create and amend a script element to the last position of the\n    // head tag that actually makes the request to the rqURL.\n\n    document.getElementsByTagName('head')[0].appendChild(function () {\n      var s = document.createElement('script');\n      s.type = 'text/javascript';\n      s.charset = 'UTF-8';\n      s.src = rqURL;\n      return s;\n    }());\n  } // //////////////////////// PUBLIC INTERFACE /////////////////////////\n\n\n  BoxeverJERS.errors = {\n    /**\n     * This method processes an Error by constructing a JSON message with\n     * data from the Error and sending it to the server\n     */\n    push: function push() {\n      for (var i = 0; i < arguments.length; i++) {\n        try {\n          if (typeof arguments[i] === \"function\") {\n            // If the argument is a function just call the function\n            arguments[i]();\n          } else {\n            var data = arguments[i];\n            var newData = {};\n\n            if (typeof data === 'string') {\n              newData.message = data;\n            } else {\n              if (typeof data.name !== \"undefined\" && data.name !== null) {\n                // Name of error object in IE 6 is an object,\n                // so need to convert to string\n                newData.name = data.name.toString();\n              } else {\n                newData.name = \"\";\n              }\n\n              if (typeof data.message !== \"undefined\" && data.message !== null) {\n                newData.message = data.message;\n              } else {\n                newData.message = \"\";\n              }\n\n              if (typeof data.stack !== \"undefined\" && data.stack !== null) {\n                newData.stack = data.stack;\n              } else {\n                newData.stack = \"\";\n              }\n            } // Set the parent url to the current pages location\n\n\n            newData.parent_url = document.location.href; // Convert JSON object to String and send\n\n            var msg = __JSON.stringify(newData);\n\n            sendErrorMessage(msg);\n          }\n        } catch (e) {\n          var msg = {\n            \"message\": \"Unknown error occured sending error report\"\n          };\n          msg = __JSON.stringify(msg);\n          sendErrorMessage(msg);\n        }\n      }\n    }\n  }; // If the old queue is an array then we need to pass all the queue\n  // arguments to the new push function to be processed\n\n  if (Object.prototype.toString.call(oldQueue) === '[object Array]') {\n    BoxeverJERS.errors.push.apply(BoxeverJERS.errors, oldQueue);\n    /**\n     * Set up the settings\n     */\n\n    if (typeof BoxeverJERS.settings !== \"undefined\") {\n      if (typeof BoxeverJERS.settings.client_key !== \"undefined\") {\n        client_key = BoxeverJERS.settings.client_key;\n      }\n\n      if (typeof BoxeverJERS.settings.client_key !== \"undefined\") {\n        target = BoxeverJERS.settings.target;\n      }\n    }\n  }\n\n  this.validateSettings = function (_boxever_settings) {\n    if (!_boxever_settings.hasOwnProperty(\"client_key\")) {\n      throw Error(\"Configuration property 'client_key' is required\");\n    }\n\n    if (!_boxever_settings.hasOwnProperty(\"target\")) {\n      throw Error(\"Configuration property 'target' is required\");\n    }\n  };\n\n  this.initSettings = function () {\n    this.validateSettings(_boxever_settings); // Set up the settings\n\n    client_key = _boxever_settings.client_key;\n    target = _boxever_settings.target;\n  };\n\n  this.init = function () {\n    this.initSettings();\n  };\n\n  init();\n})(); // //////////////////////// LEGACY CODE //////////////////////\n// //////////////////////// PUBLIC VARIABLES /////////////////\n\n\nvar _boxever_error_service = _boxever_error_service || {\n  \"errors\": []\n};\n\n(function () {\n  // //////////////////////// PRIVATE VARIABLES ///////////////////////\n  var oldQueue = _boxever_error_service.errors; // If the old queue is an array then we need to pass all the queue\n  // arguments to the new push function to be processed\n\n  if (Object.prototype.toString.call(oldQueue) === '[object Array]') {\n    BoxeverJERS.errors.push.apply(BoxeverJERS.errors, oldQueue);\n  } // //////////////////////// PUBLIC INTERFACE /////////////////////////\n\n\n  _boxever_error_service = BoxeverJERS;\n})();\n/*\n * a backwards compatable implementation of postMessage\n * by Josh Fraser (joshfraser.com)\n * released under the Apache 2.0 license.\n *\n * this code was adapted from Ben Alman's jQuery postMessage code found at:\n * http://benalman.com/projects/jquery-postmessage-plugin/\n *\n * other inspiration was taken from Luke Shepard's code for Facebook Connect:\n * http://github.com/facebook/connect-js/blob/master/src/core/xd.js\n *\n * the goal of this project was to make a backwards compatable version of postMessage\n * without having any dependency on jQuery or the FB Connect libraries\n *\n * my goal was to keep this as terse as possible since my own purpose was to use this\n * as part of a distributed widget where filesize could be sensative.\n *\n */\n\n\nvar BoxeverCrossDomain = BoxeverCrossDomain || function () {\n  var interval_id,\n      last_hash,\n      cache_bust = 1,\n      attached_callback,\n      window = this;\n  return {\n    postMessage: function postMessage(message, target_url, target) {\n      if (!target_url) {\n        return;\n      } // default to parent\n\n\n      target = target || parent;\n\n      if (window['postMessage']) {\n        // the browser supports window.postMessage, so call it with a targetOrigin\n        // set appropriately, based on the target_url parameter.\n        target['postMessage'](message, target_url.replace(/([^:]+:\\/\\/[^\\/]+).*/, '$1'));\n      } else if (target_url) {\n        // the browser does not support window.postMessage, so set the location\n        // of the target to target_url#message. A bit ugly, but it works! A cache\n        // bust parameter is added to ensure that repeat messages trigger the callback.\n        target.location = target_url.replace(/#.*$/, '') + '#' + +new Date() + cache_bust++ + '&' + message;\n      }\n    },\n    receiveMessage: function receiveMessage(callback, source_origin) {\n      // browser supports window.postMessage\n      if (window['postMessage']) {\n        // Unbind an existing callback if it exists.\n        if (attached_callback) {\n          if (window['removeEventListener']) {\n            window['removeEventListener']('message', attached_callback, !1);\n          } else {\n            window['detachEvent']('onmessage', attached_callback);\n          }\n        } // Bind the callback to the actual event associated with window.postMessage\n\n\n        if (callback) {\n          attached_callback = function attached_callback(e) {\n            // check if origin of message is the same as expected source origin\n            if (typeof source_origin === 'string' && e.origin !== source_origin || Object.prototype.toString.call(source_origin) === \"[object Function]\" && source_origin(e.origin) === !1) {\n              return !1;\n            }\n\n            callback(e);\n          }; // Bind callback\n\n\n          if (window['addEventListener']) {\n            window['addEventListener']('message', attached_callback, !1);\n          } else {\n            window['attachEvent']('onmessage', attached_callback);\n          }\n        }\n      } else {\n        // Clear existing polling loop\n        interval_id && clearInterval(interval_id);\n        interval_id = null; // A polling loop is started & callback is called whenever the location.hash changes\n\n        if (callback) {\n          interval_id = setInterval(function () {\n            var hash = document.location.hash,\n                re = /^#?\\d+&/;\n\n            if (hash !== last_hash && re.test(hash)) {\n              last_hash = hash;\n              callback({\n                data: hash.replace(re, '')\n              });\n            }\n          }, 100);\n        }\n      }\n    }\n  };\n}(); // Create the boxever queue.\n\n\nvar _boxeverq = _boxeverq || [];\n\nfunction __boxever() {\n  this.version = '1.3.2';\n  this.client_key;\n  this.target;\n  this.cookie_name;\n  this.cookie_domain;\n  this.cookie_path = '/';\n  this.cookie_expires_days = 730;\n  this.browser_id = 'anonymous';\n  this.cross_domain_origin;\n  this.cross_domain_url;\n  this.token_counter = 1;\n  this.proxy_url = 'boxever-proxy.html';\n  this.token = 0;\n  this.event = null;\n  this.flag_ttl = 40 * 60 * 1000; // 40 minutes in milliseconds\n\n  __boxeverQueue = function __boxeverQueue() {\n    this.push = function () {\n      for (var i = 0; i < arguments.length; i++) {\n        try {\n          if (typeof arguments[i] === \"function\") {\n            arguments[i]();\n          }\n        } catch (e) {\n          BoxeverJERS.errors.push(e); // TODO Should we throw? throw e;\n        }\n      }\n    };\n  };\n\n  this.setCookie = function (c_name, value, exdays) {\n    var c_value = encodeURI(value); // Set expire date on cookie\n\n    if (typeof exdays !== \"undefined\" && exdays !== null) {\n      var exdate = new Date();\n      exdate.setDate(exdate.getDate() + exdays);\n      c_value = c_value + \"; expires=\" + exdate.toUTCString();\n    } // Set path on cookie\n\n\n    c_value = c_value + \"; path=\" + this.cookie_path; // Set the domain on the cookie\n\n    if (typeof this.cookie_domain !== \"undefined\" && this.cookie_domain !== null && this.cookie_domain.length > 0) {\n      c_value = c_value + \"; domain=\" + this.cookie_domain;\n    }\n\n    document.cookie = c_name + \"=\" + c_value;\n  };\n\n  this.getCookie = function (c_name) {\n    var i,\n        x,\n        y,\n        ARRcookies = document.cookie.split(\";\");\n\n    for (i = 0; i < ARRcookies.length; i++) {\n      x = ARRcookies[i].substr(0, ARRcookies[i].indexOf(\"=\"));\n      y = ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\") + 1);\n      x = x.replace(/^\\s+|\\s+$/g, \"\");\n\n      if (x == c_name) {\n        y = decodeURI(y);\n        return y;\n      }\n    }\n  };\n\n  this.storage = null;\n\n  this.consoleLogData = function (data) {// console.log(data);\n  };\n\n  this.getVersion = function () {\n    return this.version;\n  };\n\n  this.getID = function () {\n    return this.browser_id;\n  };\n\n  this.getClientKey = function () {\n    return this.client_key;\n  };\n\n  this.getTarget = function (ver) {\n    // To support both v1.2 where as no ver parameter provided\n    // and new v2\n    if (ver) {\n      return this.target.replace('v1.2', 'v' + ver);\n    } else {\n      return this.target;\n    }\n  };\n\n  this.getCookieName = function () {\n    return this.cookie_name;\n  };\n\n  this.getCookieDomain = function () {\n    return this.cookie_domain;\n  };\n\n  this.getCookiePath = function () {\n    return this.cookie_path;\n  };\n\n  this.getCookieExpiresDays = function () {\n    return this.cookie_expires_days;\n  };\n\n  this.reset = function () {\n    _boxeverq = [];\n\n    if (this.storage) {\n      this.storage.removeItem(this.cookie_name);\n    }\n\n    this.init();\n  };\n\n  this.resetCookieName = function () {\n    if (this.storage) {\n      this.storage.removeItem(this.cookie_name);\n    }\n  };\n\n  this.getURLParameter = function (name) {\n    return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [, \"\"])[1].replace(/\\+/g, '%20')) || null;\n  }; // Code from http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript?a=1&utm_a=2&utm_b=3&utm_b=4\n\n\n  function getURLParams(decodeFun) {\n    var match,\n        pl = /\\+/g,\n        // Regex for replacing addition symbol with a space\n    search = /([^&=]+)=?([^&]*)/g,\n        decode = function decode(s) {\n      return decodeFun(s.replace(pl, \" \"));\n    },\n        query = window.location.search.substring(1);\n\n    var urlParams = {};\n\n    while (match = search.exec(query)) {\n      urlParams[decode(match[1])] = decode(match[2]);\n    }\n\n    return urlParams;\n  }\n\n  this.checkCookieEnabled = function () {\n    var isEnabled = false;\n\n    try {\n      this.setCookie(\"boxever_test\", \"text_value\", 1);\n      var isEnabled = this.getCookie(\"boxever_test\") == \"text_value\";\n      this.setCookie(\"boxever_test\", \"text_value\", -1);\n    } catch (e) {}\n\n    return isEnabled;\n  };\n\n  this.checkStorageEnabled = function () {\n    return BoxeverStorage.storageAvailable();\n  };\n\n  this.initRegular = function () {\n    var cookieValue = this.storage.getItem(this.cookie_name);\n\n    if (cookieValue != undefined && cookieValue != null && cookieValue.length > 0) {\n      // Update the cookie expiration time to be the current time plus\n      // cookie_expires_days\n      this.storage.setItem(this.cookie_name, cookieValue, this.cookie_expires_days);\n      this.browser_id = cookieValue; // get the existing _boxeverq array\n\n      var _old_boxeverq = _boxeverq; // create a new _boxeverq object\n\n      _boxeverq = new __boxeverQueue(); // execute all of the queued up events - apply() turns the array\n      // entries into individual arguments\n\n      _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n    } else {\n      this.browserCreate('{}', function (data) {\n        try {\n          if (data != undefined && data.ref != undefined) {\n            _boxever.browser_id = data.ref; // Set the cookie expiration time to be the current time\n            // plus cookie_expires_days\n\n            _boxever.storage.setItem(_boxever.cookie_name, _boxever.browser_id, _boxever.cookie_expires_days); // get the existing _boxeverq array\n\n\n            var _old_boxeverq = _boxeverq; // create a new _boxeverq object\n\n            _boxeverq = new __boxeverQueue(); // execute all of the queued up events - apply()\n            // turns the array entries into individual arguments\n\n            _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n          }\n        } catch (e) {\n          BoxeverJERS.errors.push(e);\n          throw e;\n        }\n      }, 'json');\n    }\n  };\n\n  this.addUTMParams = function (eventObj) {\n    // URL could be encoded by encodeURIComponent, escape or\n    // not encoded at all\n    var decodeFun;\n\n    try {\n      decodeURIComponent(window.location.search);\n      decodeFun = decodeURIComponent;\n    } catch (err) {\n      // If decodeURIComponent fails, fall into unescape\n      try {\n        unescape(window.location.search);\n        decodeFun = unescape;\n      } catch (err2) {// If unescape fails, not parses URL\n      }\n    }\n\n    if (decodeFun) {\n      var params = getURLParams(decodeFun);\n\n      for (var p in params) {\n        // Capture utm attributes and campaign execution ref\n        if (p.indexOf('utm_') == 0 || p.indexOf('UTM_') == 0 || p === 'b_cer' || p === 'utr') {\n          eventObj[p] = params[p];\n        }\n      }\n    }\n\n    return eventObj;\n  };\n\n  this.callIfFlagIsFalse = function (flagKey, callback, timeout) {\n    var flagVal = false; // Session cookie doesn't work in Chrome & FF, so use localStorage\n\n    if (this.checkStorageEnabled()) {\n      flagVal = BoxeverStorage.get(flagKey, false);\n    }\n\n    try {\n      if (!flagVal) {\n        callback();\n\n        if (this.checkStorageEnabled()) {\n          var TTL = this.flag_ttl;\n\n          if (timeout !== undefined) {\n            TTL = timeout;\n          }\n\n          BoxeverStorage.set(flagKey, true, {\n            TTL: TTL\n          });\n        }\n      }\n    } catch (e) {\n      BoxeverJERS.errors.push(e);\n    }\n  };\n\n  this.eventPublish = function (_event, _callback, _format) {\n    // This assumes that target is in the format of \"https://api.example.com/v1.2\" or \"https://api.example.com/v2\"\n    var baseUrl = this.target.split(\"/v\")[0];\n    var version = this.target.split(\"/v\")[1];\n    var srcURL = this.proxy_url + '?token=' + this.token_counter + '&baseUrl=' + baseUrl + '&version=' + version + '&client_key=' + this.client_key + '&event=' + encodeURIComponent(__JSON.stringify(_event));\n    this.token_counter++;\n\n    (function () {\n      var i = document.createElement('iframe');\n      i.style.display = 'none';\n      i.width = \"0\";\n      i.height = \"0\";\n      i.src = srcURL;\n      document.body.appendChild(i);\n    })();\n\n    _callback();\n  };\n\n  this.isCookied = function () {\n    var cookieValue = this.storage.getItem(this.cookie_name);\n    return cookieValue != undefined && cookieValue != null && cookieValue.length > 0;\n  };\n\n  this.consume = function () {\n    if (this.token > 1) {\n      this.initRegular();\n    }\n  };\n\n  this.onCookieConsume = function () {\n    _boxever.isCookied() ? _boxever.consume() : setTimeout(function () {\n      _boxever.onCookieConsume();\n    }, 10);\n  };\n\n  this.initConsumer = function () {\n    var __token = this.getURLParameter('token');\n\n    var __event = this.getURLParameter('event');\n\n    if (typeof __token !== \"undefined\" && __token != null && typeof __event !== \"undefined\" && __event != null) {\n      this.token = __token;\n      this.event = __JSON.parse(__event); // Push the event onto the boxever queue\n\n      _boxeverq.push(function () {\n        _boxever.event.browser_id = _boxever.getID();\n\n        _boxever.eventCreate(_boxever.event, function (_data) {}, 'json');\n      });\n\n      if (__token == 1) {\n        // Process the queue now\n        this.initRegular();\n      } else {\n        // Wait for cookie then consume\n        this.onCookieConsume();\n      }\n    } else {\n      BoxeverJERS.errors.push(\"consumer token or event is undefined or null\");\n    }\n  };\n\n  this.initPublisher = function () {\n    // Replace the eventCreate method with eventPublish method\n    this.eventCreate = this.eventPublish; // get the existing _boxeverq array\n\n    var _old_boxeverq = _boxeverq; // create a new _boxeverq object\n\n    _boxeverq = new __boxeverQueue(); // execute all of the queued up events - apply() turns the array\n    // entries into individual arguments\n\n    _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n  };\n\n  this.initCrossDomain = function () {\n    // In the case of cross domain we must use cookies as they must expire\n    // after a session so that the new value is retrieved from the 3rd party\n    // site.\n    var cookieValue = this.getCookie(this.cookie_name);\n\n    if (cookieValue != undefined && cookieValue != null && cookieValue.length > 0) {\n      this.browser_id = cookieValue; // get the existing _boxeverq array\n\n      var _old_boxeverq = _boxeverq; // create a new _boxeverq object\n\n      _boxeverq = new __boxeverQueue(); // execute all of the queued up events - apply() turns the array\n      // entries into individual arguments\n\n      _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n    } else if (this.checkCookieEnabled()) {\n      var origin = this.cross_domain_origin;\n      var frameURL = this.cross_domain_url;\n      var frameURL = frameURL + \"?\";\n      var frameURL = frameURL + \"client_key=\" + encodeURIComponent(this.getClientKey());\n      var frameURL = frameURL + \"&\";\n      var frameURL = frameURL + \"parent_url=\" + encodeURIComponent(window.location);\n      BoxeverCrossDomain.receiveMessage(function (e) {\n        try {\n          // When an iframe is created, a newFrame message is sent to window\n          // which is filtered out since type of it is object\n          // There also are scenarios where random strings sent to\n          // iframe, so check bid length\n          if (e != undefined && e.data != undefined && typeof e.data == 'string' && e.data.length == 36) {\n            _boxever.browser_id = e.data; // As we only want the cookie to be stored for\n            // the web session don't set expiry date\n\n            _boxever.setCookie(_boxever.getCookieName(), e.data); // get the existing _boxeverq array\n\n\n            var _old_boxeverq = _boxeverq; // create a new _boxeverq object\n\n            _boxeverq = new __boxeverQueue(); // execute all of the queued up events - apply()\n            // turns the array entries into individual\n            // arguments\n\n            _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n          }\n        } catch (e) {\n          BoxeverJERS.errors.push(e);\n          throw e;\n        }\n      }, origin);\n      document.getElementsByTagName('body')[0].appendChild(function () {\n        var f = document.createElement('iframe');\n        f.style.cssText = 'visibility:hidden;display:none';\n        f.width = 0;\n        f.height = 0;\n        f.src = frameURL;\n        return f;\n      }());\n    }\n  };\n\n  this.validateSettings = function (_boxever_settings) {\n    if (!_boxever_settings.hasOwnProperty(\"client_key\")) {\n      throw Error(\"Configuration property 'client_key' is required\");\n    }\n\n    if (!_boxever_settings.hasOwnProperty(\"target\")) {\n      throw Error(\"Configuration property 'target' is required\");\n    }\n\n    if (!_boxever_settings.hasOwnProperty(\"cookie_domain\")) {\n      throw Error(\"Configuration property 'cookie_domain' is required\");\n    }\n  };\n\n  this.initSettings = function () {\n    this.validateSettings(_boxever_settings);\n    _boxever_settings.client_key = \"tcuoyusxynzjnpqalwnz3hb4rwv9l2gg\";\n    _boxever_settings.target = 'https://dev-api.boxever.com/v1.2';\n    _boxever_settings.cookie_domain = \".easyjet.com\"; // Set up the settings\n\n    this.client_key = _boxever_settings.client_key;\n    this.cookie_name = \"bid_\" + _boxever_settings.client_key;\n    this.target = _boxever_settings.target;\n    this.cookie_domain = _boxever_settings.cookie_domain;\n\n    if (typeof _boxever_settings.publisher != \"undefined\") {\n      if (typeof _boxever_settings.publisher.url != \"undefined\") {\n        this.proxy_url = _boxever_settings.publisher.url;\n      }\n    } else if (typeof _boxever_settings.cross_domain !== \"undefined\") {\n      if (typeof _boxever_settings.cross_domain.origin != \"undefined\") {\n        this.cross_domain_origin = _boxever_settings.cross_domain.origin;\n      }\n\n      if (typeof _boxever_settings.cross_domain.url != \"undefined\") {\n        this.cross_domain_url = _boxever_settings.cross_domain.url;\n      }\n    } // Set storage\n\n\n    if (this.checkCookieEnabled()) {\n      // Set storage to cookie store if cookies are enabled\n      this.storage = {\n        setItem: function setItem(name, value, expires) {\n          _boxever.setCookie(name, value, expires);\n        },\n        getItem: function getItem(name) {\n          return _boxever.getCookie(name);\n        },\n        removeItem: function removeItem(name) {\n          _boxever.setCookie(name, '', -1);\n\n          return true;\n        }\n      };\n    } else if (this.checkStorageEnabled()) {\n      // Set storage to bStorage if cookies are disabled and\n      // bStorage is enabled\n      this.storage = {\n        setItem: function setItem(key, value, options) {\n          BoxeverStorage.set(key, value, options);\n        },\n        getItem: function getItem(key, def) {\n          return BoxeverStorage.get(key, def);\n        },\n        removeItem: function removeItem(key) {\n          return BoxeverStorage.deleteKey(key);\n        }\n      };\n    }\n  };\n\n  this.init = function () {\n    try {\n      // Initialize Settings\n      this.initSettings(); // No persist storage available and not a publisher\n\n      if (!this.storage && typeof _boxever_settings.publisher == \"undefined\") {\n        return;\n      } // Initialize\n\n\n      if (typeof _boxever_settings.publisher != \"undefined\") {\n        this.initPublisher();\n      } else if (typeof _boxever_settings.consumer != \"undefined\") {\n        this.initConsumer();\n      } else if (typeof _boxever_settings.cross_domain !== \"undefined\") {\n        this.initCrossDomain();\n      } else {\n        this.initRegular();\n      }\n    } catch (e) {\n      BoxeverJERS.errors.push(e);\n      throw e;\n    }\n  };\n}\n\nvar Boxever = Boxever || new __boxever(); //Extend With API Core Functions\n\n/*\n * ----------------------------- BoxeverAPICore -------------------------------------\n *\n * Dependencies: Boxever's boxever_jsonp.js, Boxever's json2.js, Boxever's boxever_xml.js\n */\n\n(function (bx) {\n  // The get method\n  bx.get = function (rqURL, callback) {\n    if (callback === '') {\n      callback = 'BoxeverUtils.consoleLogData';\n    } // Call the function to do cross-domain call\n    // ? will be replaced by a random callback name\n\n\n    rqURL = rqURL + \"&callback=?\";\n    BoxeverJSONP.exec(rqURL, callback);\n  }; // The post method can accept data as a json or xml String, xml document or\n  // json object\n\n\n  bx.post = function (rqURL, data, callback) {\n    if (callback === '') {\n      callback = 'BoxeverUtils.consoleLogData';\n    }\n\n    var message = \"\";\n\n    if (BoxeverXML.isXML(data)) {\n      // Convert xml object to string\n      message = BoxeverXML.xml2string(data);\n    } else if (typeof data === 'string' && data.charAt(0) == '<') {\n      message = data;\n    } else if (typeof data === 'string' && data.charAt(0) == '{') {\n      // Parse it and then stringify it to remove indentation\n      message = __JSON.stringify(__JSON.parse(data));\n    } else {\n      // Convert JSON object to String\n      message = __JSON.stringify(data);\n    } // Call the function to do cross-domain call\n    // ? will be replaced by a random callback name\n    // Cater for both v2 (without client key parameter)\n    // and v1.2 (with client key parameter)\n\n\n    if (rqURL.indexOf('?') == -1) {\n      rqURL = rqURL + '?';\n    } else {\n      rqURL = rqURL + '&';\n    }\n\n    rqURL = rqURL + \"message=\" + encodeURIComponent(message) + \"&callback=?\";\n    BoxeverJSONP.exec(rqURL, callback);\n  };\n})(Boxever); // Extend With API 1.2 Functions\n\n/*\n * ----------------------------- Boxever_API_1_2 -------------------------------------\n *\n * Dependencies: Boxever's boxever_api_core.js\n */\n\n\n(function (bx) {\n  // //////////////////////// PRIVATE METHODS ////////////////////////\n  function createResourcePublic(resource, data, callback, format, boxever_version, content_version) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/create.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    if (typeof boxever_version != 'undefined') rqURL = rqURL + '&boxever_version=' + boxever_version;\n    if (typeof content_version != 'undefined') rqURL = rqURL + '&content_version=' + content_version;\n    var callbackErrorHandling = bx.post(rqURL, data, function (data) {\n      try {\n        // The following occurs when the browser_id in the request is invalid\n        // {\"status\":\"NOT_FOUND\",\"error_msg\":\"Invalid browser id/ref specified\"}\n        if (\"NOT_FOUND\" === data.status && \"Invalid browser id/ref specified\" === data.error_msg) {\n          // The browser id/ref is not valid so delete the cookie and wait for next page refresh to reset cookie\n          var msg = \"Resetting cookie name for browser id/ref \" + bx.getID() + \" for client_key \" + bx.getClientKey();\n          bx.resetCookieName();\n          BoxeverJERS.errors.push(msg);\n        }\n      } catch (e) {}\n\n      callback(data);\n    });\n  }\n\n  function createResource(resource, data, api_token, callback, format) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/create.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    rqURL = rqURL + '&';\n    rqURL = rqURL + 'api_token=' + api_token;\n    bx.post(rqURL, data, callback);\n  }\n\n  function showResource(resource, ref, api_token, callback, format) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/';\n    rqURL = rqURL + ref;\n    rqURL = rqURL + '/show.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    rqURL = rqURL + '&';\n    rqURL = rqURL + 'api_token=' + api_token;\n    bx.get(rqURL, callback);\n  }\n\n  function searchResource(resource, data, api_token, callback, format) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/search.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    rqURL = rqURL + '&';\n    rqURL = rqURL + 'api_token=' + api_token;\n\n    if (data !== null && data.indexOf('=') > 0) {\n      var firstEqual = data.indexOf('=');\n      var name = encodeURIComponent(data.substring(0, firstEqual)); // Don't substring firstEqual+1 to handle = being the last character\n      // Only replace the first one so people can put '=' in the parameter value...\n\n      var value = encodeURIComponent(data.substring(firstEqual).replace('=', ''));\n      rqURL = rqURL + '&';\n      rqURL = rqURL + name + '=' + value;\n    }\n\n    bx.get(rqURL, callback);\n  }\n\n  function updateResource(resource, ref, data, api_token, callback, format) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/';\n    rqURL = rqURL + ref;\n    rqURL = rqURL + '/update.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    rqURL = rqURL + '&';\n    rqURL = rqURL + 'api_token=' + api_token;\n    bx.post(rqURL, data, callback);\n  }\n\n  function deleteResource(resource, ref, entity, api_token, callback, format) {\n    var rqURL = bx.getTarget();\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    rqURL = rqURL + '/';\n    rqURL = rqURL + ref;\n\n    if (entity !== null && entity.length > 0) {\n      rqURL = rqURL + '/' + encodeURIComponent(entity);\n    }\n\n    rqURL = rqURL + '/delete.';\n    rqURL = rqURL + format;\n    rqURL = rqURL + '?';\n    rqURL = rqURL + 'client_key=' + bx.getClientKey();\n    rqURL = rqURL + '&';\n    rqURL = rqURL + 'api_token=' + api_token;\n    bx.get(rqURL, callback);\n  } // //////////////////////// PUBLIC METHODS ////////////////////////\n  // --------------------------------\n  // Ping 1.2 API: Create\n  // --------------------------------\n\n\n  bx.pingCreate = function (data, callback, format) {\n    createResourcePublic('ping', data, callback, format);\n  }; // --------------------------------\n  // Event 1.2 API: Create, Show, Search\n  // --------------------------------\n\n\n  bx.eventCreate = function (data, callback, format) {\n    createResourcePublic('event', data, callback, format, \"1.3.2\", typeof _boxever_content_version != 'undefined' ? _boxever_content_version : undefined);\n  };\n\n  bx.eventShow = function (ref, api_token, callback, format) {\n    showResource('event', ref, api_token, callback, format);\n  };\n\n  bx.eventSearch = function (data, api_token, callback, format) {\n    searchResource('event', data, api_token, callback, format);\n  }; // --------------------------------\n  // Browser 1.2 API - Create used to establish browser identity for visiting client, Show to see the mapping\n  // --------------------------------\n\n\n  bx.browserCreate = function (data, callback, format) {\n    createResourcePublic('browser', data, callback, format);\n  };\n\n  bx.browserShow = function (ref, api_token, callback, format) {\n    showResource('browser', ref, api_token, callback, format);\n  }; // --------------------------------\n  // Customer 1.2 API: Create, Show, Update, Delete, Search\n  // --------------------------------\n\n\n  bx.customerCreate = function (data, api_token, callback, format) {\n    createResource('customer', data, api_token, callback, format);\n  };\n\n  bx.customerShow = function (ref, api_token, callback, format) {\n    showResource('customer', ref, api_token, callback, format);\n  };\n\n  bx.customerUpdate = function (ref, data, api_token, callback, format) {\n    updateResource('customer', ref, data, api_token, callback, format);\n  };\n\n  bx.customerDelete = function (ref, entity, api_token, callback, format) {\n    deleteResource('customer', ref, entity, api_token, callback, format);\n  };\n\n  bx.customerSearch = function (data, api_token, callback, format) {\n    searchResource('customer', data, api_token, callback, format);\n  }; // --------------------------------\n  // Customerdata 1.2 API: Create, Show, Update, Delete\n  // --------------------------------\n\n\n  bx.customerDataCreate = function (data, api_token, callback, format) {\n    createResource('customerdata', data, api_token, callback, format);\n  };\n\n  bx.customerDataShow = function (ref, api_token, callback, format) {\n    showResource('customerdata', ref, api_token, callback, format);\n  };\n\n  bx.customerDataUpdate = function (ref, data, api_token, callback, format) {\n    updateResource('customerdata', ref, data, api_token, callback, format);\n  };\n\n  bx.customerDataDelete = function (ref, entity, api_token, callback, format) {\n    deleteResource('customerdata', ref, entity, api_token, callback, format);\n  }; // --------------------------------\n  // Campaign 1.2 API: Create, Show\n  // --------------------------------\n\n\n  bx.campaignCreate = function (data, callback, format) {\n    createResourcePublic('campaign', data, callback, format);\n  };\n\n  bx.campaignShow = function (data, callback, format) {\n    showResource('campaign', ref, api_token, callback, format);\n  };\n\n  bx.campaignSearch = function (data, api_token, callback, format) {\n    searchResource('campaign', data, api_token, callback, format);\n  }; // --------------------------------\n  // Audit 1.2 API: Show, Search\n  // --------------------------------\n\n\n  bx.auditShow = function (ref, api_token, callback, format) {\n    showResource('audit', ref, api_token, callback, format);\n  };\n\n  bx.auditSearch = function (data, api_token, callback, format) {\n    searchResource('audit', data, api_token, callback, format);\n  }; // --------------------------------\n  // Profile 1.2 API: Create, Show, Update, Search\n  // --------------------------------\n\n\n  bx.profileCreate = function (data, api_token, callback, format) {\n    createResourcePublic('profile', data, callback, format);\n  };\n\n  bx.profileShow = function (ref, api_token, callback, format) {\n    showResource('profile', ref, api_token, callback, format);\n  };\n\n  bx.profileUpdate = function (data, ref, api_token, callback, format) {\n    updateResource('profile', ref, data, api_token, callback, format);\n  };\n\n  bx.profileSearch = function (data, api_token, callback, format) {\n    searchResource('profile', data, api_token, callback, format);\n  };\n})(Boxever); // Extend With API 2 Functions\n\n/*\n * ----------------------------- Boxever_API_2 -------------------------------------\n *\n * Dependencies: Boxever's boxever_api_core.js\n */\n\n\n(function (bx) {\n  // //////////////////////// PRIVATE METHODS ////////////////////////\n  function createV2ResourcePublic(resource, data, callback) {\n    var rqURL = bx.getTarget('2');\n    rqURL = rqURL + '/';\n    rqURL = rqURL + resource;\n    bx.post(rqURL, data, callback);\n  } // //////////////////////// PUBLIC METHODS ////////////////////////\n  // --------------------------------\n  // FlowExecution 2 API: Create\n  // --------------------------------\n\n\n  bx.flowExecutionCreate = function (data, callback) {\n    createV2ResourcePublic('flowExecutions', data, callback);\n  }; // --------------------------------\n  // Engage 2 API\n  // --------------------------------\n\n\n  bx.callFlows = function (data, callback) {\n    createV2ResourcePublic('callFlows', data, callback);\n  };\n})(Boxever); //Legacy Declaration\n\n\nvar _boxever = Boxever;\n\n_boxever.init();","map":{"version":3,"sources":["/Users/richardflynn/Documents/templates/all_in_one_multikart_react/front-end/src/services/boxever.js"],"names":["__JSON","f","n","Date","prototype","to__JSON","key","isFinite","valueOf","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","String","Number","Boolean","cx","escapable","gap","indent","meta","rep","quote","string","lastIndex","test","replace","a","c","charCodeAt","toString","slice","str","holder","i","k","v","length","mind","partial","value","call","Object","apply","join","push","hasOwnProperty","stringify","replacer","space","Error","parse","text","reviver","j","walk","undefined","eval","SyntaxError","BoxeverStorage","BSTORAGE_VERSION","$","window","jQuery","JSON","decode","evalJSON","parseJSON","toJSON","encode","_storage","__bstorage_meta","CRC32","_storage_service","bStorage","_storage_elm","_storage_size","_backend","_observers","_observer_timeout","_observer_update","_pubsub_observers","_pubsub_last","_ttl_timeout","_XMLService","isXML","elm","documentElement","ownerDocument","nodeName","xmlNode","XMLSerializer","serializeToString","E1","xml","E2","_init","localStorageReallyWorks","localStorage","setItem","removeItem","BogusQuotaExceededErrorOnIos5","bStorage_update","E3","globalStorage","location","hostname","E4","document","createElement","addBehavior","style","behavior","getElementsByTagName","appendChild","load","E","setAttribute","save","data","getAttribute","E5","E6","_load_storage","_handleTTL","_setupObserver","_handlePubSub","addEventListener","event","persisted","_storageObserver","_reloadData","attachEvent","setInterval","updateTime","clearTimeout","setTimeout","_checkUpdatedKeys","oldCrc32List","newCrc32List","updated","removed","substr","_fireObservers","keys","action","concat","len","jlen","_publishChange","_save","_dropOldEvents","E7","_checkKey","TypeError","curtime","TTL","nextExpire","Infinity","changed","deleted","PubSub","pubelm","_pubsubCurrent","_fireSubscribers","channel","payload","retire","splice","_publish","unshift","murmurhash2_32_gc","seed","l","h","version","set","options","deleteKey","_is_xml","setTTL","get","def","ttl","getTTL","flush","storageObj","F","index","storageSize","currentBackend","storageAvailable","listenKeyChange","callback","stopListening","subscribe","publish","reInit","BoxeverXML","elem","xml2string","xmlDom","doc","unescape","BoxeverJSONP","exec","rqURL","callb","Math","random","scriptElement","getElementById","parentNode","removeChild","e","DOMParser","parser","parseFromString","s","type","charset","src","async","id","_boxever_settings","BoxeverJERS","client_key","target","oldQueue","errors","sendErrorMessage","message","encodeURIComponent","arguments","newData","name","stack","parent_url","href","msg","settings","validateSettings","initSettings","init","_boxever_error_service","BoxeverCrossDomain","interval_id","last_hash","cache_bust","attached_callback","postMessage","target_url","parent","receiveMessage","source_origin","origin","clearInterval","hash","re","_boxeverq","__boxever","cookie_name","cookie_domain","cookie_path","cookie_expires_days","browser_id","cross_domain_origin","cross_domain_url","token_counter","proxy_url","token","flag_ttl","__boxeverQueue","setCookie","c_name","exdays","c_value","encodeURI","exdate","setDate","getDate","toUTCString","cookie","getCookie","x","y","ARRcookies","split","indexOf","decodeURI","storage","consoleLogData","getVersion","getID","getClientKey","getTarget","ver","getCookieName","getCookieDomain","getCookiePath","getCookieExpiresDays","reset","resetCookieName","getURLParameter","decodeURIComponent","RegExp","search","getURLParams","decodeFun","match","pl","query","substring","urlParams","checkCookieEnabled","isEnabled","checkStorageEnabled","initRegular","cookieValue","getItem","_old_boxeverq","browserCreate","ref","_boxever","addUTMParams","eventObj","err","err2","params","p","callIfFlagIsFalse","flagKey","timeout","flagVal","eventPublish","_event","_callback","_format","baseUrl","srcURL","display","width","height","body","isCookied","consume","onCookieConsume","initConsumer","__token","__event","eventCreate","_data","initPublisher","initCrossDomain","frameURL","cssText","publisher","url","cross_domain","expires","consumer","Boxever","bx","post","charAt","createResourcePublic","resource","format","boxever_version","content_version","callbackErrorHandling","status","error_msg","createResource","api_token","showResource","searchResource","firstEqual","updateResource","deleteResource","entity","pingCreate","_boxever_content_version","eventShow","eventSearch","browserShow","customerCreate","customerShow","customerUpdate","customerDelete","customerSearch","customerDataCreate","customerDataShow","customerDataUpdate","customerDataDelete","campaignCreate","campaignShow","campaignSearch","auditShow","auditSearch","profileCreate","profileShow","profileUpdate","profileSearch","createV2ResourcePublic","flowExecutionCreate","callFlows"],"mappings":"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","sourcesContent":["/* Copyright (c) 2016, BOXEVER Ltd. info@boxever.com\n *\n * Permission to use, copy, modify, and/or distribute this software for any\n * purpose with or without fee is hereby granted, provided that the above\n * copyright notice and this permission notice appear in all copies, unless\n * agreed otherwise.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE\n * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n * PERFORMANCE OF THIS SOFTWARE.\n *\n * Date: 2018-09-19T07:43Z\n */\n\n//Note: To reduce load times, this script will be cached by the client for a\n//period of one hour. ETag-based versioning will also be used.\n\n/*\n    json2.js\n    2011-10-19\n\n    Public Domain.\n\n    NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n\n    See http://www.__JSON.org/js.html\n\n\n    This code should be minified before deployment.\n    See http://javascript.crockford.com/jsmin.html\n\n    USE YOUR OWN COPY. IT IS EXTREMELY UNWISE TO LOAD CODE FROM SERVERS YOU DO\n    NOT CONTROL.\n\n\n    This file creates a global __JSON object containing two methods: stringify\n    and parse.\n\n        __JSON.stringify(value, replacer, space)\n            value       any JavaScript value, usually an object or array.\n\n            replacer    an optional parameter that determines how object\n                        values are stringified for objects. It can be a\n                        function or an array of strings.\n\n            space       an optional parameter that specifies the indentation\n                        of nested structures. If it is omitted, the text will\n                        be packed without extra whitespace. If it is a number,\n                        it will specify the number of spaces to indent at each\n                        level. If it is a string (such as '\\t' or '&nbsp;'),\n                        it contains the characters used to indent at each level.\n\n            This method produces a __JSON text from a JavaScript value.\n\n            When an object value is found, if the object contains a to__JSON\n            method, its to__JSON method will be called and the result will be\n            stringified. A to__JSON method does not serialize: it returns the\n            value represented by the name/value pair that should be serialized,\n            or undefined if nothing should be serialized. The to__JSON method\n            will be passed the key associated with the value, and this will be\n            bound to the value\n\n            For example, this would serialize Dates as ISO strings.\n\n                Date.prototype.to__JSON = function (key) {\n                    function f(n) {\n                        // Format integers to have at least two digits.\n                        return n < 10 ? '0' + n : n;\n                    }\n\n                    return this.getUTCFullYear()   + '-' +\n                         f(this.getUTCMonth() + 1) + '-' +\n                         f(this.getUTCDate())      + 'T' +\n                         f(this.getUTCHours())     + ':' +\n                         f(this.getUTCMinutes())   + ':' +\n                         f(this.getUTCSeconds())   + 'Z';\n                };\n\n            You can provide an optional replacer method. It will be passed the\n            key and value of each member, with this bound to the containing\n            object. The value that is returned from your method will be\n            serialized. If your method returns undefined, then the member will\n            be excluded from the serialization.\n\n            If the replacer parameter is an array of strings, then it will be\n            used to select the members to be serialized. It filters the results\n            such that only members with keys listed in the replacer array are\n            stringified.\n\n            Values that do not have __JSON representations, such as undefined or\n            functions, will not be serialized. Such values in objects will be\n            dropped; in arrays they will be replaced with null. You can use\n            a replacer function to replace those with __JSON values.\n            __JSON.stringify(undefined) returns undefined.\n\n            The optional space parameter produces a stringification of the\n            value that is filled with line breaks and indentation to make it\n            easier to read.\n\n            If the space parameter is a non-empty string, then that string will\n            be used for indentation. If the space parameter is a number, then\n            the indentation will be that many spaces.\n\n            Example:\n\n            text = __JSON.stringify(['e', {pluribus: 'unum'}]);\n            // text is '[\"e\",{\"pluribus\":\"unum\"}]'\n\n\n            text = __JSON.stringify(['e', {pluribus: 'unum'}], null, '\\t');\n            // text is '[\\n\\t\"e\",\\n\\t{\\n\\t\\t\"pluribus\": \"unum\"\\n\\t}\\n]'\n\n            text = __JSON.stringify([new Date()], function (key, value) {\n                return this[key] instanceof Date ?\n                    'Date(' + this[key] + ')' : value;\n            });\n            // text is '[\"Date(---current time---)\"]'\n\n\n        __JSON.parse(text, reviver)\n            This method parses a __JSON text to produce an object or array.\n            It can throw a SyntaxError exception.\n\n            The optional reviver parameter is a function that can filter and\n            transform the results. It receives each of the keys and values,\n            and its return value is used instead of the original value.\n            If it returns what it received, then the structure is not modified.\n            If it returns undefined then the member is deleted.\n\n            Example:\n\n            // Parse the text. Values that look like ISO date strings will\n            // be converted to Date objects.\n\n            myData = __JSON.parse(text, function (key, value) {\n                var a;\n                if (typeof value === 'string') {\n                    a =\n/^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2}(?:\\.\\d*)?)Z$/.exec(value);\n                    if (a) {\n                        return new Date(Date.UTC(+a[1], +a[2] - 1, +a[3], +a[4],\n                            +a[5], +a[6]));\n                    }\n                }\n                return value;\n            });\n\n            myData = __JSON.parse('[\"Date(09/09/2001)\"]', function (key, value) {\n                var d;\n                if (typeof value === 'string' &&\n                        value.slice(0, 5) === 'Date(' &&\n                        value.slice(-1) === ')') {\n                    d = new Date(value.slice(5, -1));\n                    if (d) {\n                        return d;\n                    }\n                }\n                return value;\n            });\n\n\n    This is a reference implementation. You are free to copy, modify, or\n    redistribute.\n*/\n\n/*jslint evil: true, regexp: true */\n\n/*members \"\", \"\\b\", \"\\t\", \"\\n\", \"\\f\", \"\\r\", \"\\\"\", __JSON, \"\\\\\", apply,\n    call, charCodeAt, getUTCDate, getUTCFullYear, getUTCHours,\n    getUTCMinutes, getUTCMonth, getUTCSeconds, hasOwnProperty, join,\n    lastIndex, length, parse, prototype, push, replace, slice, stringify,\n    test, to__JSON, toString, valueOf\n*/\n\n\n// Create a __JSON object only if one does not already exist. We create the\n// methods in a closure to avoid creating global variables.\n\nvar __JSON;\nif (!__JSON) {\n    __JSON = {};\n}\n\n(function () {\n    'use strict';\n\n    function f(n) {\n        // Format integers to have at least two digits.\n        return n < 10 ? '0' + n : n;\n    }\n\n    if (typeof Date.prototype.to__JSON !== 'function') {\n\n        Date.prototype.to__JSON = function (key) {\n\n            return isFinite(this.valueOf())\n                ? this.getUTCFullYear()     + '-' +\n                    f(this.getUTCMonth() + 1) + '-' +\n                    f(this.getUTCDate())      + 'T' +\n                    f(this.getUTCHours())     + ':' +\n                    f(this.getUTCMinutes())   + ':' +\n                    f(this.getUTCSeconds())   + 'Z'\n                : null;\n        };\n\n        String.prototype.to__JSON      =\n            Number.prototype.to__JSON  =\n            Boolean.prototype.to__JSON = function (key) {\n                return this.valueOf();\n            };\n    }\n\n    var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n        escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n        gap,\n        indent,\n        meta = {    // table of character substitutions\n            '\\b': '\\\\b',\n            '\\t': '\\\\t',\n            '\\n': '\\\\n',\n            '\\f': '\\\\f',\n            '\\r': '\\\\r',\n            '\"' : '\\\\\"',\n            '\\\\': '\\\\\\\\'\n        },\n        rep;\n\n\n    function quote(string) {\n\n// If the string contains no control characters, no quote characters, and no\n// backslash characters, then we can safely slap some quotes around it.\n// Otherwise we must also replace the offending characters with safe escape\n// sequences.\n\n        escapable.lastIndex = 0;\n        return escapable.test(string) ? '\"' + string.replace(escapable, function (a) {\n            var c = meta[a];\n            return typeof c === 'string'\n                ? c\n                : '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n        }) + '\"' : '\"' + string + '\"';\n    }\n\n\n    function str(key, holder) {\n\n// Produce a string from holder[key].\n\n        var i,          // The loop counter.\n            k,          // The member key.\n            v,          // The member value.\n            length,\n            mind = gap,\n            partial,\n            value = holder[key];\n\n// If the value has a to__JSON method, call it to obtain a replacement value.\n\n        if (value && typeof value === 'object' &&\n                typeof value.to__JSON === 'function') {\n            value = value.to__JSON(key);\n        }\n\n// If we were called with a replacer function, then call the replacer to\n// obtain a replacement value.\n\n        if (typeof rep === 'function') {\n            value = rep.call(holder, key, value);\n        }\n\n// What happens next depends on the value's type.\n\n        switch (typeof value) {\n        case 'string':\n            return quote(value);\n\n        case 'number':\n\n// __JSON numbers must be finite. Encode non-finite numbers as null.\n\n            return isFinite(value) ? String(value) : 'null';\n\n        case 'boolean':\n        case 'null':\n\n// If the value is a boolean or null, convert it to a string. Note:\n// typeof null does not produce 'null'. The case is included here in\n// the remote chance that this gets fixed someday.\n\n            return String(value);\n\n// If the type is 'object', we might be dealing with an object or an array or\n// null.\n\n        case 'object':\n\n// Due to a specification blunder in ECMAScript, typeof null is 'object',\n// so watch out for that case.\n\n            if (!value) {\n                return 'null';\n            }\n\n// Make an array to hold the partial results of stringifying this object value.\n\n            gap += indent;\n            partial = [];\n\n// Is the value an array?\n\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n\n// The value is an array. Stringify every element. Use null as a placeholder\n// for non-__JSON values.\n\n                length = value.length;\n                for (i = 0; i < length; i += 1) {\n                    partial[i] = str(i, value) || 'null';\n                }\n\n// Join all of the elements together, separated with commas, and wrap them in\n// brackets.\n\n                v = partial.length === 0\n                    ? '[]'\n                    : gap\n                    ? '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']'\n                    : '[' + partial.join(',') + ']';\n                gap = mind;\n                return v;\n            }\n\n// If the replacer is an array, use it to select the members to be stringified.\n\n            if (rep && typeof rep === 'object') {\n                length = rep.length;\n                for (i = 0; i < length; i += 1) {\n                    if (typeof rep[i] === 'string') {\n                        k = rep[i];\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            } else {\n\n// Otherwise, iterate through all of the keys in the object.\n\n                for (k in value) {\n                    if (Object.prototype.hasOwnProperty.call(value, k)) {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n\n// Join all of the member texts together, separated with commas,\n// and wrap them in braces.\n\n            v = partial.length === 0\n                ? '{}'\n                : gap\n                ? '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + '}'\n                : '{' + partial.join(',') + '}';\n            gap = mind;\n            return v;\n        }\n    }\n\n// If the __JSON object does not yet have a stringify method, give it one.\n\n    if (typeof __JSON.stringify !== 'function') {\n        __JSON.stringify = function (value, replacer, space) {\n\n// The stringify method takes a value and an optional replacer, and an optional\n// space parameter, and returns a __JSON text. The replacer can be a function\n// that can replace values, or an array of strings that will select the keys.\n// A default replacer method can be provided. Use of the space parameter can\n// produce text that is more easily readable.\n\n            var i;\n            gap = '';\n            indent = '';\n\n// If the space parameter is a number, make an indent string containing that\n// many spaces.\n\n            if (typeof space === 'number') {\n                for (i = 0; i < space; i += 1) {\n                    indent += ' ';\n                }\n\n// If the space parameter is a string, it will be used as the indent string.\n\n            } else if (typeof space === 'string') {\n                indent = space;\n            }\n\n// If there is a replacer, it must be a function or an array.\n// Otherwise, throw an error.\n\n            rep = replacer;\n            if (replacer && typeof replacer !== 'function' &&\n                    (typeof replacer !== 'object' ||\n                    typeof replacer.length !== 'number')) {\n                throw new Error('__JSON.stringify');\n            }\n\n// Make a fake root object containing our value under the key of ''.\n// Return the result of stringifying the value.\n\n            return str('', {'': value});\n        };\n    }\n\n\n// If the __JSON object does not yet have a parse method, give it one.\n\n    if (typeof __JSON.parse !== 'function') {\n        __JSON.parse = function (text, reviver) {\n\n// The parse method takes a text and an optional reviver function, and returns\n// a JavaScript value if the text is a valid __JSON text.\n\n            var j;\n\n            function walk(holder, key) {\n\n// The walk method is used to recursively walk the resulting structure so\n// that modifications can be made.\n\n                var k, v, value = holder[key];\n                if (value && typeof value === 'object') {\n                    for (k in value) {\n                        if (Object.prototype.hasOwnProperty.call(value, k)) {\n                            v = walk(value, k);\n                            if (v !== undefined) {\n                                value[k] = v;\n                            } else {\n                                delete value[k];\n                            }\n                        }\n                    }\n                }\n                return reviver.call(holder, key, value);\n            }\n\n\n// Parsing happens in four stages. In the first stage, we replace certain\n// Unicode characters with escape sequences. JavaScript handles many characters\n// incorrectly, either silently deleting them, or treating them as line endings.\n\n            text = String(text);\n            cx.lastIndex = 0;\n            if (cx.test(text)) {\n                text = text.replace(cx, function (a) {\n                    return '\\\\u' +\n                        ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n                });\n            }\n\n// In the second stage, we run the text against regular expressions that look\n// for non-__JSON patterns. We are especially concerned with '()' and 'new'\n// because they can cause invocation, and '=' because it can cause mutation.\n// But just to be safe, we want to reject all unexpected forms.\n\n// We split the second stage into 4 regexp operations in order to work around\n// crippling inefficiencies in IE's and Safari's regexp engines. First we\n// replace the __JSON backslash pairs with '@' (a non-__JSON character). Second, we\n// replace all simple value tokens with ']' characters. Third, we delete all\n// open brackets that follow a colon or comma or that begin the text. Finally,\n// we look to see that the remaining characters are only whitespace or ']' or\n// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\n            if (/^[\\],:{}\\s]*$/\n                    .test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')\n                        .replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']')\n                        .replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\n\n// In the third stage we use the eval function to compile the text into a\n// JavaScript structure. The '{' operator is subject to a syntactic ambiguity\n// in JavaScript: it can begin a block or an object literal. We wrap the text\n// in parens to eliminate the ambiguity.\n\n                j = eval('(' + text + ')');\n\n// In the optional fourth stage, we recursively walk the new structure, passing\n// each name/value pair to a reviver function for possible transformation.\n\n                return typeof reviver === 'function'\n                    ? walk({'': j}, '')\n                    : j;\n            }\n\n// If the text is not __JSON parseable, then a SyntaxError is thrown.\n\n            throw new SyntaxError('__JSON.parse');\n        };\n    }\n}());\n/*\n * ----------------------------- JSTORAGE -------------------------------------\n * Simple local storage wrapper to save data on the browser side, supporting\n * all major browsers - IE6+, Firefox2+, Safari4+, Chrome4+ and Opera 10.5+\n *\n * Copyright (c) 2010 - 2012 Andris Reinman, andris.reinman@gmail.com\n * Project homepage: www.jstorage.info\n *\n * Licensed under MIT-style license:\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nvar BoxeverStorage = BoxeverStorage || {};\n\n (function(){\n    var\n        /* bStorage version */\n        BSTORAGE_VERSION = \"0.4.3\",\n\n        /* detect a dollar object or create one if not found */\n        $ = window.jQuery || window.$ || (window.$ = {}),\n\n        /* check for a JSON handling support */\n        JSON = {\n            parse:\n                window.JSON && (window.JSON.parse || window.JSON.decode) ||\n                window.__JSON && window.__JSON.parse ||\n                __JSON && __JSON.parse ||\n                String.prototype.evalJSON && function(str){return String(str).evalJSON();} ||\n                $.parseJSON ||\n                $.evalJSON,\n            stringify:\n                Object.toJSON ||\n                window.JSON && (window.JSON.stringify || window.JSON.encode) ||\n                window.__JSON && window.__JSON.stringify ||\n                __JSON && __JSON.stringify ||\n                $.toJSON\n        };\n\n    // Break if no JSON support was found\n    if(!JSON.parse || !JSON.stringify){\n        throw new Error(\"No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page\");\n    }\n\n    var\n        /* This is the object, that holds the cached values */\n        _storage = {__bstorage_meta:{CRC32:{}}},\n\n        /* Actual browser storage (localStorage or globalStorage['domain']) */\n        _storage_service = {bStorage:\"{}\"},\n\n        /* DOM element for older IE versions, holds userData behavior */\n        _storage_elm = null,\n\n        /* How much space does the storage take */\n        _storage_size = 0,\n\n        /* which backend is currently used */\n        _backend = false,\n\n        /* onchange observers */\n        _observers = {},\n\n        /* timeout to wait after onchange event */\n        _observer_timeout = false,\n\n        /* last update time */\n        _observer_update = 0,\n\n        /* pubsub observers */\n        _pubsub_observers = {},\n\n        /* skip published items older than current timestamp */\n        _pubsub_last = +new Date(),\n\n        /* Next check for TTL */\n        _ttl_timeout,\n\n        /**\n         * XML encoding and decoding as XML nodes can't be JSON'ized\n         * XML nodes are encoded and decoded if the node is the value to be saved\n         * but not if it's as a property of another object\n         * Eg. -\n         *   $.bStorage.set(\"key\", xmlNode);        // IS OK\n         *   $.bStorage.set(\"key\", {xml: xmlNode}); // NOT OK\n         */\n        _XMLService = {\n\n            /**\n             * Validates a XML node to be XML\n             * based on jQuery.isXML function\n             */\n            isXML: function(elm){\n                var documentElement = (elm ? elm.ownerDocument || elm : 0).documentElement;\n                return documentElement ? documentElement.nodeName !== \"HTML\" : false;\n            },\n\n            /**\n             * Encodes a XML node to string\n             * based on http://www.mercurytide.co.uk/news/article/issues-when-working-ajax/\n             */\n            encode: function(xmlNode) {\n                if(!this.isXML(xmlNode)){\n                    return false;\n                }\n                try{ // Mozilla, Webkit, Opera\n                    return new XMLSerializer().serializeToString(xmlNode);\n                }catch(E1) {\n                    try {  // IE\n                        return xmlNode.xml;\n                    }catch(E2){}\n                }\n                return false;\n            },\n\n            /**\n             * Decodes a XML node from string\n             * loosely based on http://outwestmedia.com/jquery-plugins/xmldom/\n             */\n            // decode: function(xmlString){\n            //     var dom_parser = (\"DOMParser\" in window && (new DOMParser()).parseFromString) ||\n            //             (window.ActiveXObject && function(_xmlString) {\n            //         var xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n            //         xml_doc.async = 'false';\n            //         xml_doc.loadXML(_xmlString);\n            //         return xml_doc;\n            //     }),\n            //     resultXML;\n            //     if(!dom_parser){\n            //         return false;\n            //     }\n            //     resultXML = dom_parser.call(\"DOMParser\" in window && (new DOMParser()) || window, xmlString, 'text/xml');\n            //     return this.isXML(resultXML)?resultXML:false;\n            // }\n        };\n\n\n    ////////////////////////// PRIVATE METHODS ////////////////////////\n\n    /**\n     * Initialization function. Detects if the browser supports DOM Storage\n     * or userData behavior and behaves accordingly.\n     */\n    function _init(){\n        /* Check if browser supports localStorage */\n        var localStorageReallyWorks = false;\n        if(\"localStorage\" in window){\n            try {\n                window.localStorage.setItem('_tmptest', 'tmpval');\n                localStorageReallyWorks = true;\n                window.localStorage.removeItem('_tmptest');\n            } catch(BogusQuotaExceededErrorOnIos5) {\n                // Thanks be to iOS5 Private Browsing mode which throws\n                // QUOTA_EXCEEDED_ERRROR DOM Exception 22.\n            }\n        }\n\n        if(localStorageReallyWorks){\n            try {\n                if(window.localStorage) {\n                    _storage_service = window.localStorage;\n                    _backend = \"localStorage\";\n                    _observer_update = _storage_service.bStorage_update;\n                }\n            } catch(E3) {/* Firefox fails when touching localStorage and cookies are disabled */}\n        }\n        /* Check if browser supports globalStorage */\n        else if(\"globalStorage\" in window){\n            try {\n                if(window.globalStorage) {\n\t\t\t\t\tif(window.location.hostname == 'localhost'){\n\t\t\t\t\t\t_storage_service = window.globalStorage['localhost.localdomain'];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t_storage_service = window.globalStorage[window.location.hostname];\n\t\t\t\t\t}\n                    _backend = \"globalStorage\";\n                    _observer_update = _storage_service.bStorage_update;\n                }\n            } catch(E4) {/* Firefox fails when touching localStorage and cookies are disabled */}\n        }\n        /* Check if browser supports userData behavior */\n        else {\n            _storage_elm = document.createElement('link');\n            if(_storage_elm.addBehavior){\n\n                /* Use a DOM element to act as userData storage */\n                _storage_elm.style.behavior = 'url(#default#userData)';\n\n                /* userData element needs to be inserted into the DOM! */\n                document.getElementsByTagName('head')[0].appendChild(_storage_elm);\n\n                try{\n                    _storage_elm.load(\"bStorage\");\n                }catch(E){\n                    // try to reset cache\n                    _storage_elm.setAttribute(\"bStorage\", \"{}\");\n                    _storage_elm.save(\"bStorage\");\n                    _storage_elm.load(\"bStorage\");\n                }\n\n                var data = \"{}\";\n                try{\n                    data = _storage_elm.getAttribute(\"bStorage\");\n                }catch(E5){}\n\n                try{\n                    _observer_update = _storage_elm.getAttribute(\"bStorage_update\");\n                }catch(E6){}\n\n                _storage_service.bStorage = data;\n                _backend = \"userDataBehavior\";\n            }else{\n                _storage_elm = null;\n                return;\n            }\n        }\n\n        // Load data from storage\n        _load_storage();\n\n        // remove dead keys\n        _handleTTL();\n\n        // start listening for changes\n        _setupObserver();\n\n        // initialize publish-subscribe service\n        _handlePubSub();\n\n        // handle cached navigation\n        if(\"addEventListener\" in window){\n            window.addEventListener(\"pageshow\", function(event){\n                if(event.persisted){\n                    _storageObserver();\n                }\n            }, false);\n        }\n    }\n\n    /**\n     * Reload data from storage when needed\n     */\n    function _reloadData(){\n        var data = \"{}\";\n\n        if(_backend == \"userDataBehavior\"){\n            _storage_elm.load(\"bStorage\");\n\n            try{\n                data = _storage_elm.getAttribute(\"bStorage\");\n            }catch(E5){}\n\n            try{\n                _observer_update = _storage_elm.getAttribute(\"bStorage_update\");\n            }catch(E6){}\n\n            _storage_service.bStorage = data;\n        }\n\n        _load_storage();\n\n        // remove dead keys\n        _handleTTL();\n\n        _handlePubSub();\n    }\n\n    /**\n     * Sets up a storage change observer\n     */\n    function _setupObserver(){\n        if(_backend == \"localStorage\" || _backend == \"globalStorage\"){\n            if(\"addEventListener\" in window){\n                window.addEventListener(\"storage\", _storageObserver, false);\n            }else{\n                document.attachEvent(\"onstorage\", _storageObserver);\n            }\n        }else if(_backend == \"userDataBehavior\"){\n            setInterval(_storageObserver, 1000);\n        }\n    }\n\n    /**\n     * Fired on any kind of data change, needs to check if anything has\n     * really been changed\n     */\n    function _storageObserver(){\n        var updateTime;\n        // cumulate change notifications with timeout\n        clearTimeout(_observer_timeout);\n        _observer_timeout = setTimeout(function(){\n\n            if(_backend == \"localStorage\" || _backend == \"globalStorage\"){\n                updateTime = _storage_service.bStorage_update;\n            }else if(_backend == \"userDataBehavior\"){\n                _storage_elm.load(\"bStorage\");\n                try{\n                    updateTime = _storage_elm.getAttribute(\"bStorage_update\");\n                }catch(E5){}\n            }\n\n            if(updateTime && updateTime != _observer_update){\n                _observer_update = updateTime;\n                _checkUpdatedKeys();\n            }\n\n        }, 25);\n    }\n\n    /**\n     * Reloads the data and checks if any keys are changed\n     */\n    function _checkUpdatedKeys(){\n        var oldCrc32List = JSON.parse(JSON.stringify(_storage.__bstorage_meta.CRC32)),\n            newCrc32List;\n\n        _reloadData();\n        newCrc32List = JSON.parse(JSON.stringify(_storage.__bstorage_meta.CRC32));\n\n        var key,\n            updated = [],\n            removed = [];\n\n        for(key in oldCrc32List){\n            if(oldCrc32List.hasOwnProperty(key)){\n                if(!newCrc32List[key]){\n                    removed.push(key);\n                    continue;\n                }\n                if(oldCrc32List[key] != newCrc32List[key] && String(oldCrc32List[key]).substr(0,2) == \"2.\"){\n                    updated.push(key);\n                }\n            }\n        }\n\n        for(key in newCrc32List){\n            if(newCrc32List.hasOwnProperty(key)){\n                if(!oldCrc32List[key]){\n                    updated.push(key);\n                }\n            }\n        }\n\n        _fireObservers(updated, \"updated\");\n        _fireObservers(removed, \"deleted\");\n    }\n\n    /**\n     * Fires observers for updated keys\n     *\n     * @param {Array|String} keys Array of key names or a key\n     * @param {String} action What happened with the value (updated, deleted, flushed)\n     */\n    function _fireObservers(keys, action){\n        keys = [].concat(keys || []);\n        if(action == \"flushed\"){\n            keys = [];\n            for(var key in _observers){\n                if(_observers.hasOwnProperty(key)){\n                    keys.push(key);\n                }\n            }\n            action = \"deleted\";\n        }\n        for(var i=0, len = keys.length; i<len; i++){\n            if(_observers[keys[i]]){\n                for(var j=0, jlen = _observers[keys[i]].length; j<jlen; j++){\n                    _observers[keys[i]][j](keys[i], action);\n                }\n            }\n            if(_observers[\"*\"]){\n                for(var j=0, jlen = _observers[\"*\"].length; j<jlen; j++){\n                    _observers[\"*\"][j](keys[i], action);\n                }\n            }\n        }\n    }\n\n    /**\n     * Publishes key change to listeners\n     */\n    function _publishChange(){\n        var updateTime = (+new Date()).toString();\n\n        if(_backend == \"localStorage\" || _backend == \"globalStorage\"){\n            _storage_service.bStorage_update = updateTime;\n        }else if(_backend == \"userDataBehavior\"){\n            _storage_elm.setAttribute(\"bStorage_update\", updateTime);\n            _storage_elm.save(\"bStorage\");\n        }\n\n        _storageObserver();\n    }\n\n    /**\n     * Loads the data from the storage based on the supported mechanism\n     */\n    function _load_storage(){\n        /* if bStorage string is retrieved, then decode it */\n        if(_storage_service.bStorage){\n            try{\n                _storage = JSON.parse(String(_storage_service.bStorage));\n            }catch(E6){_storage_service.bStorage = \"{}\";}\n        }else{\n            _storage_service.bStorage = \"{}\";\n        }\n        _storage_size = _storage_service.bStorage?String(_storage_service.bStorage).length:0;\n\n        if(!_storage.__bstorage_meta){\n            _storage.__bstorage_meta = {};\n        }\n        if(!_storage.__bstorage_meta.CRC32){\n            _storage.__bstorage_meta.CRC32 = {};\n        }\n    }\n\n    /**\n     * This functions provides the \"save\" mechanism to store the bStorage object\n     */\n    function _save(){\n        _dropOldEvents(); // remove expired events\n        try{\n            _storage_service.bStorage = JSON.stringify(_storage);\n            // If userData is used as the storage engine, additional\n            if(_storage_elm) {\n                _storage_elm.setAttribute(\"bStorage\",_storage_service.bStorage);\n                _storage_elm.save(\"bStorage\");\n            }\n            _storage_size = _storage_service.bStorage?String(_storage_service.bStorage).length:0;\n        }catch(E7){/* probably cache is full, nothing is saved this way*/}\n    }\n\n    /**\n     * Function checks if a key is set and is string or numberic\n     *\n     * @param {String} key Key name\n     */\n    function _checkKey(key){\n        if(!key || (typeof key != \"string\" && typeof key != \"number\")){\n            throw new TypeError('Key name must be string or numeric');\n        }\n        if(key == \"__bstorage_meta\"){\n            throw new TypeError('Reserved key name');\n        }\n        return true;\n    }\n\n    /**\n     * Removes expired keys\n     */\n    function _handleTTL(){\n        var curtime, i, TTL, CRC32, nextExpire = Infinity, changed = false, deleted = [];\n\n        clearTimeout(_ttl_timeout);\n\n        if(!_storage.__bstorage_meta || typeof _storage.__bstorage_meta.TTL != \"object\"){\n            // nothing to do here\n            return;\n        }\n\n        curtime = +new Date();\n        TTL = _storage.__bstorage_meta.TTL;\n\n        CRC32 = _storage.__bstorage_meta.CRC32;\n        for(i in TTL){\n            if(TTL.hasOwnProperty(i)){\n                if(TTL[i] <= curtime){\n                    delete TTL[i];\n                    delete CRC32[i];\n                    delete _storage[i];\n                    changed = true;\n                    deleted.push(i);\n                }else if(TTL[i] < nextExpire){\n                    nextExpire = TTL[i];\n                }\n            }\n        }\n\n        // set next check\n        if(nextExpire != Infinity){\n            _ttl_timeout = setTimeout(_handleTTL, nextExpire - curtime);\n        }\n\n        // save changes\n        if(changed){\n            _save();\n            _publishChange();\n            _fireObservers(deleted, \"deleted\");\n        }\n    }\n\n    /**\n     * Checks if there's any events on hold to be fired to listeners\n     */\n    function _handlePubSub(){\n        var i, len;\n        if(!_storage.__bstorage_meta.PubSub){\n            return;\n        }\n        var pubelm,\n            _pubsubCurrent = _pubsub_last;\n\n        for(i=len=_storage.__bstorage_meta.PubSub.length-1; i>=0; i--){\n            pubelm = _storage.__bstorage_meta.PubSub[i];\n            if(pubelm[0] > _pubsub_last){\n                _pubsubCurrent = pubelm[0];\n                _fireSubscribers(pubelm[1], pubelm[2]);\n            }\n        }\n\n        _pubsub_last = _pubsubCurrent;\n    }\n\n    /**\n     * Fires all subscriber listeners for a pubsub channel\n     *\n     * @param {String} channel Channel name\n     * @param {Mixed} payload Payload data to deliver\n     */\n    function _fireSubscribers(channel, payload){\n        if(_pubsub_observers[channel]){\n            for(var i=0, len = _pubsub_observers[channel].length; i<len; i++){\n                // send immutable data that can't be modified by listeners\n                _pubsub_observers[channel][i](channel, JSON.parse(JSON.stringify(payload)));\n            }\n        }\n    }\n\n    /**\n     * Remove old events from the publish stream (at least 2sec old)\n     */\n    function _dropOldEvents(){\n        if(!_storage.__bstorage_meta.PubSub){\n            return;\n        }\n\n        var retire = +new Date() - 2000;\n\n        for(var i=0, len = _storage.__bstorage_meta.PubSub.length; i<len; i++){\n            if(_storage.__bstorage_meta.PubSub[i][0] <= retire){\n                // deleteCount is needed for IE6\n                _storage.__bstorage_meta.PubSub.splice(i, _storage.__bstorage_meta.PubSub.length - i);\n                break;\n            }\n        }\n\n        if(!_storage.__bstorage_meta.PubSub.length){\n            delete _storage.__bstorage_meta.PubSub;\n        }\n\n    }\n\n    /**\n     * Publish payload to a channel\n     *\n     * @param {String} channel Channel name\n     * @param {Mixed} payload Payload to send to the subscribers\n     */\n    function _publish(channel, payload){\n        if(!_storage.__bstorage_meta){\n            _storage.__bstorage_meta = {};\n        }\n        if(!_storage.__bstorage_meta.PubSub){\n            _storage.__bstorage_meta.PubSub = [];\n        }\n\n        _storage.__bstorage_meta.PubSub.unshift([+new Date, channel, payload]);\n\n        _save();\n        _publishChange();\n    }\n\n\n    /**\n     * JS Implementation of MurmurHash2\n     *\n     *  SOURCE: https://github.com/garycourt/murmurhash-js (MIT licensed)\n     *\n     * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n     * @see http://github.com/garycourt/murmurhash-js\n     * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n     * @see http://sites.google.com/site/murmurhash/\n     *\n     * @param {string} str ASCII only\n     * @param {number} seed Positive integer only\n     * @return {number} 32-bit positive integer hash\n     */\n\n    function murmurhash2_32_gc(str, seed) {\n        var\n            l = str.length,\n            h = seed ^ l,\n            i = 0,\n            k;\n\n        while (l >= 4) {\n            k =\n                ((str.charCodeAt(i) & 0xff)) |\n                ((str.charCodeAt(++i) & 0xff) << 8) |\n                ((str.charCodeAt(++i) & 0xff) << 16) |\n                ((str.charCodeAt(++i) & 0xff) << 24);\n\n            k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n            k ^= k >>> 24;\n            k = (((k & 0xffff) * 0x5bd1e995) + ((((k >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n\n            h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16)) ^ k;\n\n            l -= 4;\n            ++i;\n        }\n\n        switch (l) {\n            case 3: h ^= (str.charCodeAt(i + 2) & 0xff) << 16;\n            case 2: h ^= (str.charCodeAt(i + 1) & 0xff) << 8;\n            case 1: h ^= (str.charCodeAt(i) & 0xff);\n                h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n        }\n\n        h ^= h >>> 13;\n        h = (((h & 0xffff) * 0x5bd1e995) + ((((h >>> 16) * 0x5bd1e995) & 0xffff) << 16));\n        h ^= h >>> 15;\n\n        return h >>> 0;\n    }\n\n    ////////////////////////// PUBLIC INTERFACE /////////////////////////\n\n    BoxeverStorage = {\n        /* Version number */\n        version: BSTORAGE_VERSION,\n\n        /**\n         * Sets a key's value.\n         *\n         * @param {String} key Key to set. If this value is not set or not\n         *              a string an exception is raised.\n         * @param {Mixed} value Value to set. This can be any value that is JSON\n         *              compatible (Numbers, Strings, Objects etc.).\n         * @param {Object} [options] - possible options to use\n         * @param {Number} [options.TTL] - optional TTL value\n         * @return {Mixed} the used value\n         */\n        set: function(key, value, options){\n            _checkKey(key);\n\n            options = options || {};\n\n            // undefined values are deleted automatically\n            if(typeof value == \"undefined\"){\n                this.deleteKey(key);\n                return value;\n            }\n\n            if(_XMLService.isXML(value)){\n                value = {_is_xml:true,xml:_XMLService.encode(value)};\n            }else if(typeof value == \"function\"){\n                return undefined; // functions can't be saved!\n            }else if(value && typeof value == \"object\"){\n                // clone the object before saving to _storage tree\n                value = JSON.parse(JSON.stringify(value));\n            }\n\n            _storage[key] = value;\n\n            _storage.__bstorage_meta.CRC32[key] = \"2.\" + murmurhash2_32_gc(JSON.stringify(value), 0x9747b28c);\n\n            this.setTTL(key, options.TTL || 0); // also handles saving and _publishChange\n\n            _fireObservers(key, \"updated\");\n            return value;\n        },\n\n        /**\n         * Looks up a key in cache\n         *\n         * @param {String} key - Key to look up.\n         * @param {mixed} def - Default value to return, if key didn't exist.\n         * @return {Mixed} the key value, default value or null\n         */\n        get: function(key, def){\n            _checkKey(key);\n            if(key in _storage){\n                if(_storage[key] && typeof _storage[key] == \"object\" && _storage[key]._is_xml) {\n                    return _XMLService.decode(_storage[key].xml);\n                }else{\n                    return _storage[key];\n                }\n            }\n            return typeof(def) == 'undefined' ? null : def;\n        },\n\n        /**\n         * Deletes a key from cache.\n         *\n         * @param {String} key - Key to delete.\n         * @return {Boolean} true if key existed or false if it didn't\n         */\n        deleteKey: function(key){\n            _checkKey(key);\n            if(key in _storage){\n                delete _storage[key];\n                // remove from TTL list\n                if(typeof _storage.__bstorage_meta.TTL == \"object\" &&\n                  key in _storage.__bstorage_meta.TTL){\n                    delete _storage.__bstorage_meta.TTL[key];\n                }\n\n                delete _storage.__bstorage_meta.CRC32[key];\n\n                _save();\n                _publishChange();\n                _fireObservers(key, \"deleted\");\n                return true;\n            }\n            return false;\n        },\n\n        /**\n         * Sets a TTL for a key, or remove it if ttl value is 0 or below\n         *\n         * @param {String} key - key to set the TTL for\n         * @param {Number} ttl - TTL timeout in milliseconds\n         * @return {Boolean} true if key existed or false if it didn't\n         */\n        setTTL: function(key, ttl){\n            var curtime = +new Date();\n            _checkKey(key);\n            ttl = Number(ttl) || 0;\n            if(key in _storage){\n\n                if(!_storage.__bstorage_meta.TTL){\n                    _storage.__bstorage_meta.TTL = {};\n                }\n\n                // Set TTL value for the key\n                if(ttl>0){\n                    _storage.__bstorage_meta.TTL[key] = curtime + ttl;\n                }else{\n                    delete _storage.__bstorage_meta.TTL[key];\n                }\n\n                _save();\n\n                _handleTTL();\n\n                _publishChange();\n                return true;\n            }\n            return false;\n        },\n\n        /**\n         * Gets remaining TTL (in milliseconds) for a key or 0 when no TTL has been set\n         *\n         * @param {String} key Key to check\n         * @return {Number} Remaining TTL in milliseconds\n         */\n        getTTL: function(key){\n            var curtime = +new Date(), ttl;\n            _checkKey(key);\n            if(key in _storage && _storage.__bstorage_meta.TTL && _storage.__bstorage_meta.TTL[key]){\n                ttl = _storage.__bstorage_meta.TTL[key] - curtime;\n                return ttl || 0;\n            }\n            return 0;\n        },\n\n        /**\n         * Deletes everything in cache.\n         *\n         * @return {Boolean} Always true\n         */\n        flush: function(){\n            _storage = {__bstorage_meta:{CRC32:{}}};\n            _save();\n            _publishChange();\n            _fireObservers(null, \"flushed\");\n            return true;\n        },\n\n        /**\n         * Returns a read-only copy of _storage\n         *\n         * @return {Object} Read-only copy of _storage\n        */\n        storageObj: function(){\n            function F() {}\n            F.prototype = _storage;\n            return new F();\n        },\n\n        /**\n         * Returns an index of all used keys as an array\n         * ['key1', 'key2',..'keyN']\n         *\n         * @return {Array} Used keys\n        */\n        index: function(){\n            var index = [], i;\n            for(i in _storage){\n                if(_storage.hasOwnProperty(i) && i != \"__bstorage_meta\"){\n                    index.push(i);\n                }\n            }\n            return index;\n        },\n\n        /**\n         * How much space in bytes does the storage take?\n         *\n         * @return {Number} Storage size in chars (not the same as in bytes,\n         *                  since some chars may take several bytes)\n         */\n        storageSize: function(){\n            return _storage_size;\n        },\n\n        /**\n         * Which backend is currently in use?\n         *\n         * @return {String} Backend name\n         */\n        currentBackend: function(){\n            return _backend;\n        },\n\n        /**\n         * Test if storage is available\n         *\n         * @return {Boolean} True if storage can be used\n         */\n        storageAvailable: function(){\n            return !!_backend;\n        },\n\n        /**\n         * Register change listeners\n         *\n         * @param {String} key Key name\n         * @param {Function} callback Function to run when the key changes\n         */\n        listenKeyChange: function(key, callback){\n            _checkKey(key);\n            if(!_observers[key]){\n                _observers[key] = [];\n            }\n            _observers[key].push(callback);\n        },\n\n        /**\n         * Remove change listeners\n         *\n         * @param {String} key Key name to unregister listeners against\n         * @param {Function} [callback] If set, unregister the callback, if not - unregister all\n         */\n        stopListening: function(key, callback){\n            _checkKey(key);\n\n            if(!_observers[key]){\n                return;\n            }\n\n            if(!callback){\n                delete _observers[key];\n                return;\n            }\n\n            for(var i = _observers[key].length - 1; i>=0; i--){\n                if(_observers[key][i] == callback){\n                    _observers[key].splice(i,1);\n                }\n            }\n        },\n\n        /**\n         * Subscribe to a Publish/Subscribe event stream\n         *\n         * @param {String} channel Channel name\n         * @param {Function} callback Function to run when the something is published to the channel\n         */\n        subscribe: function(channel, callback){\n            channel = (channel || \"\").toString();\n            if(!channel){\n                throw new TypeError('Channel not defined');\n            }\n            if(!_pubsub_observers[channel]){\n                _pubsub_observers[channel] = [];\n            }\n            _pubsub_observers[channel].push(callback);\n        },\n\n        /**\n         * Publish data to an event stream\n         *\n         * @param {String} channel Channel name\n         * @param {Mixed} payload Payload to deliver\n         */\n        publish: function(channel, payload){\n            channel = (channel || \"\").toString();\n            if(!channel){\n                throw new TypeError('Channel not defined');\n            }\n\n            _publish(channel, payload);\n        },\n\n        /**\n         * Reloads the data from browser storage\n         */\n        reInit: function(){\n            _reloadData();\n        }\n    };\n\n    // Initialize bStorage\n    _init();\n\n})();\n/*\n * ----------------------------- BoxeverXML -------------------------------------\n *\n * Dependencies: None\n */\nvar BoxeverXML = {\n\t/**\n\t * Validates a XML node to be XML based on jQuery.isXML function\n\t *\n\t * @param elem\n\t *            The element to validate\n\t */\n\tisXML : function(elem) {\n\t\t// documentElement is verified for cases where it doesn't yet exist\n\t\t// (such as loading iframes in IE - #4833)\n\t\tvar documentElement = (elem ? elem.ownerDocument || elem : 0).documentElement;\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n\t},\n\n\t/**\n\t * Converts a string to an xml document\n\t *\n\t * @param str\n\t *            The xml string to convert to an xml document\n\t * @return the xml document\n\t */\n\t// string2xml : function(str) {\n\t// \tif (window.ActiveXObject) {\n\t// \t\tvar doc = new ActiveXObject(\"Microsoft.XMLDOM\");\n\t// \t\tdoc.async = \"false\";\n\t// \t\tdoc.loadXML(str);\n\t// \t}\n\t// \t// code for Mozilla, Firefox, Opera, etc.\n\t// \telse {\n\t// \t\tvar parser = new DOMParser();\n\t// \t\tvar doc = parser.parseFromString(str, \"text/xml\");\n\t// \t}\n\t// \t// documentElement always represents the root node\n\t// \treturn doc;\n\t// },\n\n\t/**\n\t * Converts a xml document to a string\n\t *\n\t * @param xmlDom\n\t *            The xml document to convert to a string\n\t * @return the string representation of the xml document\n\t */\n\txml2string : function(xmlDom) {\n\t\tvar doc = xmlDom.documentElement;\n\t\tif (doc.xml == undefined) {\n\t\t\treturn (new XMLSerializer()).serializeToString(xmlDom);\n\t\t} else {\n\t\t\treturn doc.xml;\n\t\t}\n\t},\n\n\t/**\n\t * Unescape an xml string\n\t *\n\t * @return the unescaped xml string\n\t */\n\tunescape : function(str) {\n\t\tstr = str.replace(/&lt;/gi, \"<\")\n\t\tstr = str.replace(/&gt;/gi, \">\")\n\t\tstr = str.replace(/&quot;/gi, \"\\\"\")\n\t\tstr = str.replace(/&amp;/gi, \"&\");\n\t\treturn str;\n\t}\n}\n\n/*\n * ----------------------------- BoxeverJSONP -------------------------------------\n *\n * Dependencies: Boxever's boxever_xml.js\n */\nvar BoxeverJSONP = {\n\t/**\n\t * Generic function to make cross-domain Ajax calls (jsonp)\n\t *\n\t * @param rqURL\n\t *            The request url\n\t * @param callback\n\t *            The callback function\n\t */\n\texec : function(rqURL, callback) {\n\t\t// Generate a callback function name\n\t\tvar callb = 'jsonp' + (Math.random() * 100).toString()\n\t\tcallb = callb.replace(/\\./g, '');\n\n\t\t// Replace the callback=? or cb=?\n\t\t// with the generated callback function name\n\t\trqURL = rqURL.replace('callback=?', 'callback=' + callb)\n\t\trqURL = rqURL.replace('cb=?', 'cb=' + callb)\n\n\t\t// Set a window variable to point to the callback function\n\t\twindow[callb] = function(data) {\n\t\t\ttry {\n\t\t\t\t// Do some tidying up be removing the script element\n\t\t\t\t// from the DOM once it has been executed\n\t\t\t\tvar scriptElement = document.getElementById(callb);\n\t\t\t\tscriptElement.parentNode.removeChild(scriptElement);\n\t\t\t} catch (e) {\n\t\t\t}\n\t\t\tif (typeof data === 'string') {\n\t\t\t\t// If data is of type string then the response is xml\n\t\t\t\t// therefore unescape it and parse it to xml document\n\t\t\t\tdata = BoxeverXML.unescape(data);\n\t\t\t\tif (window.DOMParser) {\n\t\t\t\t\tvar parser = new DOMParser();\n\t\t\t\t\tdata = parser.parseFromString(data, \"text/xml\");\n\t\t\t\t} else {\n\t\t\t\t\t// Internet Explorer\n\t\t\t\t\t// var xmlDoc = new ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\t\t// xmlDoc.async = false;\n\t\t\t\t\t// xmlDoc.loadXML(data);\n\t\t\t\t\t// data = xmlDoc;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Call the \"callback\" function\n\t\t\tcallback(data);\n\t\t\ttry {\n\t\t\t\t// Do some final tidying up by setting the window variable to\n\t\t\t\t// null and deleting the variable\n\t\t\t\twindow[callb] = null;\n\t\t\t\tdelete window[callb];\n\t\t\t} catch (e) {\n\t\t\t}\n\t\t};\n\n\t\t// Create and amend a script element to the last position of the head\n\t\t// tag that actually makes the request to the rqURL.\n\t\tdocument.getElementsByTagName('head')[0].appendChild((function() {\n\t\t\tvar s = document.createElement('script');\n\t\t\ts.type = 'text/javascript';\n\t\t\ts.charset = 'UTF-8';\n\t\t\ts.src = rqURL;\n\t\t\ts.async = true;\n\t\t\ts.id = callb;\n\t\t\treturn s;\n\t\t})());\n\t}\n}\n\n// Define the boxever settings.\nvar _boxever_settings = _boxever_settings || {};\n\n/*\n * ----------------------------- BoxeverJERS -------------------------------------\n * The Boxever Javascript Error Reporting Service or JERS is used to send client side\n * javascript errors to a remote server for reporting, analysing and notifications.\n *\n * Usage:\n * var BoxeverJERS = BoxeverJERS || {\"errors\" : []};\n * try {\n *     Some bad code\n * } catch(e) {\n *     BoxeverJERS.errors.push(e);\n * }\n *\n * or\n *\n * var BoxeverJERS = BoxeverJERS || {\"errors\" : []};\n * BoxeverJERS.errors.push(\"Something bad happened\");\n *\n * or\n *\n * BoxeverJERS.errors.push(function(alert(\"Something bad happened\")));\n *\n * Dependencies: Boxever's json2.js\n */\n\n// //////////////////////// PUBLIC VARIABLES //////////////////////\nvar BoxeverJERS = BoxeverJERS || {\n\t\"errors\" : []\n};\n\n(function() {\n\t// //////////////////////// PRIVATE VARIABLES //////////////////////\n\tvar client_key;\n\tvar target;\n\n\tvar oldQueue = BoxeverJERS.errors;\n\n\t// //////////////////////// PRIVATE METHODS ////////////////////////\n\t/**\n\t * Send the error message using JSONP\n\t *\n\t * @param message\n\t *            The message to send\n\t */\n\tfunction sendErrorMessage(message) {\n\t\tvar rqURL = target + '/boxever-log-js-error.js?client_key='\n\t\t\t\t+ client_key + '&message=' + encodeURIComponent(message);\n\n\t\t// Create and amend a script element to the last position of the\n\t\t// head tag that actually makes the request to the rqURL.\n\t\tdocument.getElementsByTagName('head')[0].appendChild((function() {\n\t\t\tvar s = document.createElement('script');\n\t\t\ts.type = 'text/javascript';\n\t\t\ts.charset = 'UTF-8';\n\t\t\ts.src = rqURL;\n\t\t\treturn s;\n\t\t})());\n\t}\n\n\t// //////////////////////// PUBLIC INTERFACE /////////////////////////\n\tBoxeverJERS.errors = {\n\t\t/**\n\t\t * This method processes an Error by constructing a JSON message with\n\t\t * data from the Error and sending it to the server\n\t\t */\n\t\tpush : function() {\n\t\t\tfor ( var i = 0; i < arguments.length; i++) {\n\t\t\t\ttry {\n\t\t\t\t\tif (typeof arguments[i] === \"function\") {\n\t\t\t\t\t\t// If the argument is a function just call the function\n\t\t\t\t\t\targuments[i]();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar data = arguments[i];\n\t\t\t\t\t\tvar newData = {};\n\n\t\t\t\t\t\tif (typeof data === 'string') {\n\t\t\t\t\t\t\tnewData.message = data;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (typeof data.name !== \"undefined\" && data.name !== null) {\n\t\t\t\t\t\t\t\t// Name of error object in IE 6 is an object,\n\t\t\t\t\t\t\t\t// so need to convert to string\n\t\t\t\t\t\t\t\tnewData.name = data.name.toString();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewData.name = \"\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (typeof data.message !== \"undefined\" && data.message !== null) {\n\t\t\t\t\t\t\t\tnewData.message = data.message;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewData.message = \"\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (typeof data.stack !== \"undefined\" && data.stack !== null) {\n\t\t\t\t\t\t\t\tnewData.stack = data.stack;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnewData.stack = \"\";\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Set the parent url to the current pages location\n\t\t\t\t\t\tnewData.parent_url = document.location.href;\n\n\t\t\t\t\t\t// Convert JSON object to String and send\n\t\t\t\t\t\tvar msg = __JSON.stringify(newData);\n\t\t\t\t\t\tsendErrorMessage(msg);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tvar msg = {\n\t\t\t\t\t\t\"message\" : \"Unknown error occured sending error report\"\n\t\t\t\t\t};\n\t\t\t\t\tmsg = __JSON.stringify(msg)\n\t\t\t\t\tsendErrorMessage(msg);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// If the old queue is an array then we need to pass all the queue\n\t// arguments to the new push function to be processed\n\tif (Object.prototype.toString.call(oldQueue) === '[object Array]') {\n\t\tBoxeverJERS.errors.push.apply(BoxeverJERS.errors, oldQueue);\n\n\t\t/**\n\t\t * Set up the settings\n\t\t */\n\t\tif (typeof BoxeverJERS.settings !== \"undefined\") {\n\t\t\tif (typeof BoxeverJERS.settings.client_key !== \"undefined\") {\n\t\t\t\tclient_key = BoxeverJERS.settings.client_key;\n\t\t\t}\n\t\t\tif (typeof BoxeverJERS.settings.client_key !== \"undefined\") {\n\t\t\t\ttarget = BoxeverJERS.settings.target;\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.validateSettings = function(_boxever_settings) {\n\t\tif (!_boxever_settings.hasOwnProperty(\"client_key\")) {\n\t\t\tthrow Error(\"Configuration property 'client_key' is required\");\n\t\t}\n\t\tif (!_boxever_settings.hasOwnProperty(\"target\")) {\n\t\t\tthrow Error(\"Configuration property 'target' is required\");\n\t\t}\n\t}\n\n\tthis.initSettings = function() {\n\t\tthis.validateSettings(_boxever_settings);\n\n\t\t// Set up the settings\n\t\tclient_key = _boxever_settings.client_key;\n\t\ttarget = _boxever_settings.target;\n\t}\n\n\tthis.init = function() {\n\t\tthis.initSettings();\n\t}\n\n\tinit();\n})();\n\n// //////////////////////// LEGACY CODE //////////////////////\n// //////////////////////// PUBLIC VARIABLES /////////////////\nvar _boxever_error_service = _boxever_error_service || {\n\t\"errors\" : []\n};\n\n(function() {\n\t// //////////////////////// PRIVATE VARIABLES ///////////////////////\n\tvar oldQueue = _boxever_error_service.errors;\n\n\t// If the old queue is an array then we need to pass all the queue\n\t// arguments to the new push function to be processed\n\tif (Object.prototype.toString.call(oldQueue) === '[object Array]') {\n\t\tBoxeverJERS.errors.push.apply(BoxeverJERS.errors, oldQueue);\n\t}\n\n\t// //////////////////////// PUBLIC INTERFACE /////////////////////////\n\t_boxever_error_service = BoxeverJERS;\n})();\n/*\n * a backwards compatable implementation of postMessage\n * by Josh Fraser (joshfraser.com)\n * released under the Apache 2.0 license.\n *\n * this code was adapted from Ben Alman's jQuery postMessage code found at:\n * http://benalman.com/projects/jquery-postmessage-plugin/\n *\n * other inspiration was taken from Luke Shepard's code for Facebook Connect:\n * http://github.com/facebook/connect-js/blob/master/src/core/xd.js\n *\n * the goal of this project was to make a backwards compatable version of postMessage\n * without having any dependency on jQuery or the FB Connect libraries\n *\n * my goal was to keep this as terse as possible since my own purpose was to use this\n * as part of a distributed widget where filesize could be sensative.\n *\n */\n\nvar BoxeverCrossDomain = BoxeverCrossDomain || function(){\n\n    var interval_id,\n    last_hash,\n    cache_bust = 1,\n    attached_callback,\n    window = this;\n\n    return {\n        postMessage : function(message, target_url, target) {\n\n            if (!target_url) {\n                return;\n            }\n\n            // default to parent\n            target = target || parent;\n\n            if (window['postMessage']) {\n                // the browser supports window.postMessage, so call it with a targetOrigin\n                // set appropriately, based on the target_url parameter.\n                target['postMessage'](message, target_url.replace( /([^:]+:\\/\\/[^\\/]+).*/, '$1'));\n            } else if (target_url) {\n                // the browser does not support window.postMessage, so set the location\n                // of the target to target_url#message. A bit ugly, but it works! A cache\n                // bust parameter is added to ensure that repeat messages trigger the callback.\n                target.location = target_url.replace(/#.*$/, '') + '#' + (+new Date) + (cache_bust++) + '&' + message;\n            }\n        },\n\n        receiveMessage : function(callback, source_origin) {\n\n            // browser supports window.postMessage\n            if (window['postMessage']) {\n\n            \t// Unbind an existing callback if it exists.\n\t\t\t\tif (attached_callback) {\n    \t\t        if (window['removeEventListener']) {\n\t                    window['removeEventListener']('message', attached_callback, !1);\n            \t\t} else {\n    \t\t            window['detachEvent']('onmessage', attached_callback);\n\t                }\n\t\t\t\t}\n\n\t\t\t\t// Bind the callback to the actual event associated with window.postMessage\n                if (callback) {\n                    attached_callback = function(e) {\n                    \t// check if origin of message is the same as expected source origin\n                        if ((typeof source_origin === 'string' && e.origin !== source_origin)\n                        || (Object.prototype.toString.call(source_origin) === \"[object Function]\" && source_origin(e.origin) === !1)) {\n                            return !1;\n                        }\n                        callback(e);\n                    };\n\n                    // Bind callback\n                \tif (window['addEventListener']) {\n            \t        window['addEventListener']('message', attached_callback, !1);\n        \t        } else {\n    \t                window['attachEvent']('onmessage', attached_callback);\n\t                }\n                }\n            } else {\n            \t// Clear existing polling loop\n                interval_id && clearInterval(interval_id);\n                interval_id = null;\n\n            \t// A polling loop is started & callback is called whenever the location.hash changes\n                if (callback) {\n                    interval_id = setInterval(function(){\n                        var hash = document.location.hash,\n                        re = /^#?\\d+&/;\n                        if (hash !== last_hash && re.test(hash)) {\n                            last_hash = hash;\n                            callback({data: hash.replace(re, '')});\n                        }\n                    }, 100);\n                }\n            }\n        }\n    };\n}();\n// Create the boxever queue.\nvar _boxeverq = _boxeverq || [];\n\nfunction __boxever() {\n\tthis.version = '1.3.2';\n\tthis.client_key;\n\tthis.target;\n\tthis.cookie_name;\n\tthis.cookie_domain;\n\tthis.cookie_path = '/';\n\tthis.cookie_expires_days = 730;\n\tthis.browser_id = 'anonymous';\n\n\tthis.cross_domain_origin;\n\tthis.cross_domain_url;\n\n\tthis.token_counter = 1;\n\tthis.proxy_url = 'boxever-proxy.html';\n\n\tthis.token = 0;\n\tthis.event = null;\n\n\tthis.flag_ttl = 40 * 60 * 1000; // 40 minutes in milliseconds\n\n\t__boxeverQueue = function() {\n\t    this.push = function() {\n\t        for (var i = 0; i < arguments.length; i++) {\n\t        \ttry {\n\t        \t\tif (typeof arguments[i] === \"function\") {\n\t        \t\t\targuments[i]();\n\t        \t\t}\n\t        \t} catch (e) {\n\t        \t\tBoxeverJERS.errors.push(e);\n\t        \t\t// TODO Should we throw? throw e;\n\t        \t}\n\t        }\n\t    }\n\t};\n\n\tthis.setCookie = function(c_name, value, exdays) {\n\t\tvar c_value = encodeURI(value);\n\n\t\t// Set expire date on cookie\n\t\tif (typeof exdays !== \"undefined\" && exdays !== null) {\n\t\t\tvar exdate = new Date();\n\t\t\t    exdate.setDate(exdate.getDate() + exdays);\n\t\t\tc_value = c_value + \"; expires=\" + exdate.toUTCString();\n\t\t}\n\n\t\t// Set path on cookie\n\t\tc_value = c_value + \"; path=\" + this.cookie_path;\n\n\t\t// Set the domain on the cookie\n\t\tif (typeof this.cookie_domain !== \"undefined\" && this.cookie_domain !== null && this.cookie_domain.length > 0) {\n\t\t\tc_value = c_value + \"; domain=\" + this.cookie_domain;\n\t\t}\n\t\tdocument.cookie = c_name + \"=\" + c_value;\n\t};\n\n\tthis.getCookie = function(c_name) {\n\t\tvar i, x, y, ARRcookies = document.cookie.split(\";\");\n\t\tfor (i = 0; i < ARRcookies.length; i++) {\n\t\t\tx = ARRcookies[i].substr(0, ARRcookies[i].indexOf(\"=\"));\n\t\t\ty = ARRcookies[i].substr(ARRcookies[i].indexOf(\"=\") + 1);\n\t\t\tx = x.replace(/^\\s+|\\s+$/g, \"\");\n\t\t\tif (x == c_name) {\n\t\t\t\ty = decodeURI(y);\n\t\t\t\treturn y;\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.storage = null;\n\n\tthis.consoleLogData = function(data) {\n\t\t// console.log(data);\n\t};\n\n\tthis.getVersion = function() {\n\t\treturn this.version;\n\t};\n\n\tthis.getID = function() {\n\t\treturn this.browser_id;\n\t};\n\n\tthis.getClientKey = function() {\n\t\treturn this.client_key;\n\t};\n\n\tthis.getTarget = function(ver) {\n        // To support both v1.2 where as no ver parameter provided\n        // and new v2\n        if (ver) {\n            return this.target.replace('v1.2', 'v' + ver);\n        } else {\n\t\t    return this.target;\n        }\n\t};\n\n\tthis.getCookieName = function() {\n\t\treturn this.cookie_name;\n\t};\n\n\tthis.getCookieDomain = function() {\n\t\treturn this.cookie_domain;\n\t};\n\n\tthis.getCookiePath = function() {\n\t\treturn this.cookie_path;\n\t};\n\n\tthis.getCookieExpiresDays = function() {\n\t\treturn this.cookie_expires_days;\n\t};\n\n\tthis.reset = function() {\n\t\t_boxeverq = [];\n\t\tif (this.storage) {\n\t\t\tthis.storage.removeItem(this.cookie_name);\n\t\t}\n\t\tthis.init();\n\t};\n\n    this.resetCookieName = function() {\n        if (this.storage) {\n            this.storage.removeItem(this.cookie_name);\n        }\n    };\n\n\tthis.getURLParameter = function(name) {\n\t\treturn decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,\"\"])[1].replace(/\\+/g, '%20'))||null;\n\t};\n\n\t// Code from http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript?a=1&utm_a=2&utm_b=3&utm_b=4\n\tfunction getURLParams(decodeFun) {\n\t    var match,\n\t        pl     = /\\+/g,  // Regex for replacing addition symbol with a space\n\t        search = /([^&=]+)=?([^&]*)/g,\n\t        decode = function (s) { return decodeFun(s.replace(pl, \" \")); },\n\t        query  = window.location.search.substring(1);\n\n\t    var urlParams = {};\n\t    while (match = search.exec(query)) {\n\t       urlParams[decode(match[1])] = decode(match[2]);\n\t    }\n\t    return urlParams;\n\t}\n\n\tthis.checkCookieEnabled = function(){\n\t\tvar isEnabled = false;\n\t\ttry {\n\t\t\tthis.setCookie(\"boxever_test\", \"text_value\", 1);\n\t\t\tvar isEnabled = (this.getCookie(\"boxever_test\") == \"text_value\");\n\t\t\tthis.setCookie(\"boxever_test\", \"text_value\", -1);\n\t\t} catch(e) {\n\t\t}\n\t\treturn isEnabled;\n\t};\n\n\tthis.checkStorageEnabled = function(){\n\t\treturn BoxeverStorage.storageAvailable();\n\t};\n\n\tthis.initRegular = function() {\n\t\tvar cookieValue = this.storage.getItem(this.cookie_name);\n\t\tif (cookieValue != undefined && cookieValue != null && cookieValue.length > 0) {\n                // Update the cookie expiration time to be the current time plus\n                // cookie_expires_days\n                this.storage.setItem(this.cookie_name, cookieValue, this.cookie_expires_days);\n                this.browser_id = cookieValue;\n\n                // get the existing _boxeverq array\n                var _old_boxeverq = _boxeverq;\n\n                // create a new _boxeverq object\n                _boxeverq = new __boxeverQueue();\n\n                // execute all of the queued up events - apply() turns the array\n                // entries into individual arguments\n                _boxeverq.push.apply(_boxeverq, _old_boxeverq);\n\t\t} else {\n\t\t\tthis.browserCreate('{}', function(data) {\n\t\t\t\ttry {\n\t\t\t\t\tif (data != undefined && data.ref != undefined) {\n\t\t\t\t\t\t_boxever.browser_id = data.ref;\n\t\t\t\t\t\t// Set the cookie expiration time to be the current time\n\t\t\t\t\t\t// plus cookie_expires_days\n\t\t\t\t\t\t_boxever.storage.setItem(_boxever.cookie_name, _boxever.browser_id, _boxever.cookie_expires_days);\n\n\t\t\t\t\t\t// get the existing _boxeverq array\n\t\t\t\t\t\tvar _old_boxeverq = _boxeverq;\n\n\t\t\t\t\t\t// create a new _boxeverq object\n\t\t\t\t\t\t_boxeverq = new __boxeverQueue();\n\n\t\t\t\t\t\t// execute all of the queued up events - apply()\n\t\t\t\t\t\t// turns the array entries into individual arguments\n\t\t\t\t\t\t_boxeverq.push.apply(_boxeverq, _old_boxeverq);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tBoxeverJERS.errors.push(e);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}, 'json');\n\t\t}\n\t};\n\n\tthis.addUTMParams = function (eventObj) {\n\t\t// URL could be encoded by encodeURIComponent, escape or\n\t\t// not encoded at all\n\t\tvar decodeFun;\n\t\ttry {\n\t\t\tdecodeURIComponent(window.location.search);\n\t\t\tdecodeFun = decodeURIComponent;\n\t\t} catch (err) {\n\t\t\t// If decodeURIComponent fails, fall into unescape\n\t\t\ttry {\n\t\t\t\tunescape(window.location.search);\n\t\t\t\tdecodeFun = unescape;\n\t\t\t} catch (err2) {\n\t\t\t\t// If unescape fails, not parses URL\n\t\t\t}\n\t\t}\n\n\t\tif (decodeFun) {\n\t\t\tvar params = getURLParams(decodeFun);\n\t\t\tfor (var p in params) {\n\t\t\t\t// Capture utm attributes and campaign execution ref\n\t\t\t\tif (p.indexOf('utm_') == 0 || p.indexOf('UTM_') == 0 || p === 'b_cer' || p === 'utr') {\n\t\t\t\t\teventObj[p] = params[p];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn eventObj;\n\t};\n\n\tthis.callIfFlagIsFalse = function (flagKey, callback, timeout) {\n\t\tvar flagVal = false;\n\t\t// Session cookie doesn't work in Chrome & FF, so use localStorage\n\t\tif (this.checkStorageEnabled()) {\n\t\t\tflagVal = BoxeverStorage.get(flagKey, false);\n\t\t}\n\n\t\ttry {\n\t\t\tif (!flagVal) {\n\t\t\t\tcallback();\n\t\t\t\tif (this.checkStorageEnabled()) {\n\t\t\t\t\tvar TTL = this.flag_ttl;\n\t\t\t\t\tif (timeout !== undefined) {\n\t\t\t\t\t\tTTL = timeout;\n\t\t\t\t\t}\n\t\t\t\t\tBoxeverStorage.set(flagKey, true, {TTL: TTL});\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tBoxeverJERS.errors.push(e);\n\t\t}\n\t}\n\n\tthis.eventPublish = function(_event, _callback, _format) {\n\t\t// This assumes that target is in the format of \"https://api.example.com/v1.2\" or \"https://api.example.com/v2\"\n\t\tvar baseUrl = this.target.split(\"/v\")[0];\n        var version = this.target.split(\"/v\")[1];\n\n\t\tvar srcURL = this.proxy_url + '?token=' + this.token_counter\n\t\t\t+ '&baseUrl=' + baseUrl + '&version=' + version + '&client_key=' + this.client_key + '&event=' + encodeURIComponent(__JSON.stringify(_event));\n\t\tthis.token_counter++;\n\n\t\t(function() {\n\t\t    var i = document.createElement('iframe');\n\t\t    i.style.display = 'none';\n\t\t    i.width = \"0\";\n\t\t    i.height = \"0\";\n\t\t    i.src = srcURL;\n\t\t    document.body.appendChild(i);\n\t\t})();\n\t\t_callback();\n\t};\n\n\tthis.isCookied = function() {\n\t\tvar cookieValue = this.storage.getItem(this.cookie_name);\n\t\treturn (cookieValue != undefined && cookieValue != null && cookieValue.length > 0);\n\t};\n\n\tthis.consume = function() {\n\t\tif (this.token > 1) {\n\t\t\tthis.initRegular();\n\t\t}\n\t};\n\n\tthis.onCookieConsume = function() {\n\t\t(_boxever.isCookied()) ? _boxever.consume() : setTimeout(function() {_boxever.onCookieConsume();}, 10);\n\t};\n\n\tthis.initConsumer = function() {\n\t\tvar __token = this.getURLParameter('token');\n\t\tvar __event = this.getURLParameter('event');\n\n\t\tif (typeof __token !== \"undefined\" && __token != null && typeof __event !== \"undefined\" && __event != null) {\n\t\t\tthis.token = __token;\n\t\t\tthis.event = __JSON.parse(__event);\n\n\t\t\t// Push the event onto the boxever queue\n\t\t\t_boxeverq.push(function() {\n\t\t\t\t_boxever.event.browser_id = _boxever.getID();\n\t\t\t\t_boxever.eventCreate(_boxever.event, function(_data) {}, 'json');\n\t\t\t});\n\n\t\t\tif (__token == 1) {\n\t\t\t\t// Process the queue now\n\t\t\t\tthis.initRegular();\n\t\t\t} else {\n\t\t\t\t// Wait for cookie then consume\n\t\t\t\tthis.onCookieConsume();\n\t\t\t}\n\t\t} else {\n\t\t\tBoxeverJERS.errors.push(\"consumer token or event is undefined or null\");\n\t\t}\n\t};\n\n\tthis.initPublisher = function() {\n\t\t// Replace the eventCreate method with eventPublish method\n\t\tthis.eventCreate = this.eventPublish;\n\n\t\t// get the existing _boxeverq array\n\t\tvar _old_boxeverq = _boxeverq;\n\n\t\t// create a new _boxeverq object\n\t\t_boxeverq = new __boxeverQueue();\n\n\t\t// execute all of the queued up events - apply() turns the array\n\t\t// entries into individual arguments\n\t\t_boxeverq.push.apply(_boxeverq, _old_boxeverq);\n\t};\n\n\tthis.initCrossDomain = function() {\n\t\t// In the case of cross domain we must use cookies as they must expire\n\t\t// after a session so that the new value is retrieved from the 3rd party\n\t\t// site.\n\t\tvar cookieValue = this.getCookie(this.cookie_name);\n\t\tif (cookieValue != undefined && cookieValue != null && cookieValue.length > 0) {\n\t\t\tthis.browser_id = cookieValue;\n\n\t\t\t// get the existing _boxeverq array\n\t\t\tvar _old_boxeverq = _boxeverq;\n\n\t\t\t// create a new _boxeverq object\n\t\t\t_boxeverq = new __boxeverQueue();\n\n\t\t\t// execute all of the queued up events - apply() turns the array\n\t\t\t// entries into individual arguments\n\t\t\t_boxeverq.push.apply(_boxeverq, _old_boxeverq);\n\t\t} else if (this.checkCookieEnabled()) {\n\t\t\tvar origin = this.cross_domain_origin;\n\n\t\t\tvar frameURL = this.cross_domain_url;\n\t\t\tvar frameURL = frameURL + \"?\";\n\t\t\tvar frameURL = frameURL + \"client_key=\" + encodeURIComponent(this.getClientKey());\n\t\t\tvar frameURL = frameURL + \"&\";\n\t\t\tvar frameURL = frameURL + \"parent_url=\" + encodeURIComponent(window.location);\n\n\t\t\tBoxeverCrossDomain.receiveMessage(function(e) {\n\t\t\t\ttry {\n\t\t\t\t\t// When an iframe is created, a newFrame message is sent to window\n\t\t\t\t\t// which is filtered out since type of it is object\n\t\t\t\t\t// There also are scenarios where random strings sent to\n\t\t\t\t\t// iframe, so check bid length\n\t\t\t\t\tif (e != undefined && e.data != undefined && typeof e.data == 'string' && e.data.length == 36) {\n\t\t\t\t\t\t_boxever.browser_id = e.data;\n\n\t\t\t\t\t\t// As we only want the cookie to be stored for\n\t\t\t\t\t\t// the web session don't set expiry date\n\t\t\t\t\t\t_boxever.setCookie(_boxever.getCookieName(), e.data);\n\n\t\t\t\t\t\t// get the existing _boxeverq array\n\t\t\t\t\t\tvar _old_boxeverq = _boxeverq;\n\n\t\t\t\t\t\t// create a new _boxeverq object\n\t\t\t\t\t\t_boxeverq = new __boxeverQueue();\n\n\t\t\t\t\t\t// execute all of the queued up events - apply()\n\t\t\t\t\t\t// turns the array entries into individual\n\t\t\t\t\t\t// arguments\n\t\t\t\t\t\t_boxeverq.push.apply(_boxeverq, _old_boxeverq);\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tBoxeverJERS.errors.push(e);\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}, origin);\n\n\t\t\tdocument.getElementsByTagName('body')[0].appendChild((function() {\n\t\t\t\tvar f = document.createElement('iframe');\n\t\t\t\tf.style.cssText = 'visibility:hidden;display:none';\n\t\t\t\tf.width = 0;\n\t\t\t\tf.height = 0;\n\t\t\t\tf.src = frameURL;\n\t\t\t\treturn f;\n\t\t\t})());\n\n\t\t}\n\t};\n\n\tthis.validateSettings = function(_boxever_settings) {\n\t\tif (!_boxever_settings.hasOwnProperty(\"client_key\")) {\n\t\t\tthrow Error(\"Configuration property 'client_key' is required\");\n\t\t}\n\t\tif (!_boxever_settings.hasOwnProperty(\"target\")) {\n\t\t\tthrow Error(\"Configuration property 'target' is required\");\n\t\t}\n\t\tif (!_boxever_settings.hasOwnProperty(\"cookie_domain\")) {\n\t\t\tthrow Error(\"Configuration property 'cookie_domain' is required\");\n\t\t}\n\t}\n\n\tthis.initSettings = function() {\n\t\tthis.validateSettings(_boxever_settings);\n        _boxever_settings.client_key = \"tcuoyusxynzjnpqalwnz3hb4rwv9l2gg\";\n        _boxever_settings.target = 'https://dev-api.boxever.com/v1.2';\n        _boxever_settings.cookie_domain = \".easyjet.com\";\n\n\t\t// Set up the settings\n\t\tthis.client_key = _boxever_settings.client_key;\n\t\tthis.cookie_name = \"bid_\" + _boxever_settings.client_key;\n\t\tthis.target = _boxever_settings.target;\n\t\tthis.cookie_domain = _boxever_settings.cookie_domain;\n\t\tif (typeof _boxever_settings.publisher != \"undefined\") {\n\t\t\tif (typeof _boxever_settings.publisher.url != \"undefined\") {\n\t\t\t\tthis.proxy_url = _boxever_settings.publisher.url;\n\t\t\t}\n\t\t} else if (typeof _boxever_settings.cross_domain !== \"undefined\") {\n\t\t\tif (typeof _boxever_settings.cross_domain.origin != \"undefined\") {\n\t\t\t\tthis.cross_domain_origin = _boxever_settings.cross_domain.origin;\n\t\t\t}\n\t\t\tif (typeof _boxever_settings.cross_domain.url != \"undefined\") {\n\t\t\t\tthis.cross_domain_url = _boxever_settings.cross_domain.url;\n\t\t\t}\n\t\t}\n\n        // Set storage\n        if (this.checkCookieEnabled()) {\n        \t// Set storage to cookie store if cookies are enabled\n        \tthis.storage = {\n    \t\t\tsetItem: function(name, value, expires) {\n        \t\t\t_boxever.setCookie(name, value, expires);\n        \t\t},\n        \t\tgetItem: function(name) {\n        \t\t\treturn _boxever.getCookie(name);\n        \t\t},\n        \t\tremoveItem : function(name) {\n        \t\t\t_boxever.setCookie(name, '', -1);\n        \t\t\treturn true;\n        \t\t}\n        \t}\n        } else if (this.checkStorageEnabled()) {\n        \t// Set storage to bStorage if cookies are disabled and\n\t\t\t// bStorage is enabled\n        \tthis.storage = {\n        \t\tsetItem : function (key, value, options) {\n        \t\t\tBoxeverStorage.set(key, value, options);\n        \t\t},\n        \t\tgetItem : function (key, def) {\n        \t\t\treturn BoxeverStorage.get(key, def);\n        \t\t},\n        \t\tremoveItem : function (key) {\n        \t\t\treturn BoxeverStorage.deleteKey(key);\n        \t\t}\n        \t}\n\t\t}\n\t};\n\n\tthis.init = function() {\n\t\ttry {\n\t\t\t// Initialize Settings\n\t\t\tthis.initSettings();\n\n\t\t\t// No persist storage available and not a publisher\n\t\t\tif (!this.storage && typeof _boxever_settings.publisher == \"undefined\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Initialize\n\t\t\tif (typeof _boxever_settings.publisher != \"undefined\") {\n\t\t\t\tthis.initPublisher();\n\t\t\t} else if (typeof _boxever_settings.consumer != \"undefined\") {\n\t\t\t\tthis.initConsumer();\n\t\t\t} else if (typeof _boxever_settings.cross_domain !== \"undefined\") {\n\t\t\t\tthis.initCrossDomain();\n\t\t\t} else {\n\t\t\t\tthis.initRegular();\n\t\t\t}\n\t\t} catch(e) {\n\t\t\tBoxeverJERS.errors.push(e);\n\t\t\tthrow e;\n\t\t}\n\t};\n}\nvar Boxever = Boxever || new __boxever();\n\n//Extend With API Core Functions\n/*\n * ----------------------------- BoxeverAPICore -------------------------------------\n *\n * Dependencies: Boxever's boxever_jsonp.js, Boxever's json2.js, Boxever's boxever_xml.js\n */\n(function (bx) {\n\n\t// The get method\n    bx.get = function (rqURL, callback) {\n        if (callback === '') {\n            callback = 'BoxeverUtils.consoleLogData';\n        }\n\n        // Call the function to do cross-domain call\n        // ? will be replaced by a random callback name\n        rqURL = rqURL + \"&callback=?\";\n        BoxeverJSONP.exec(rqURL, callback);\n    };\n\n    // The post method can accept data as a json or xml String, xml document or\n    // json object\n    bx.post = function (rqURL, data, callback) {\n        if (callback === '') {\n            callback = 'BoxeverUtils.consoleLogData';\n        }\n        var message = \"\";\n        if (BoxeverXML.isXML(data)) {\n            // Convert xml object to string\n            message = BoxeverXML.xml2string(data);\n        } else if (typeof data === 'string' && data.charAt(0) == '<') {\n            message = data;\n        } else if (typeof data === 'string' && data.charAt(0) == '{') {\n            // Parse it and then stringify it to remove indentation\n            message = __JSON.stringify(__JSON.parse(data));\n        } else {\n            // Convert JSON object to String\n            message = __JSON.stringify(data);\n        }\n\n        // Call the function to do cross-domain call\n        // ? will be replaced by a random callback name\n        // Cater for both v2 (without client key parameter)\n        // and v1.2 (with client key parameter)\n        if (rqURL.indexOf('?') == -1) {\n            rqURL = rqURL + '?';\n        } else {\n            rqURL = rqURL + '&';\n        }\n        rqURL = rqURL + \"message=\" + encodeURIComponent(message) + \"&callback=?\";\n        BoxeverJSONP.exec(rqURL, callback);\n    };\n\n}(Boxever));\n// Extend With API 1.2 Functions\n/*\n * ----------------------------- Boxever_API_1_2 -------------------------------------\n *\n * Dependencies: Boxever's boxever_api_core.js\n */\n(function(bx) {\n\n\t// //////////////////////// PRIVATE METHODS ////////////////////////\n\n\tfunction createResourcePublic (resource, data, callback, format, boxever_version, content_version) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/create.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\n\t\tif(typeof boxever_version != 'undefined')\n\t\t\trqURL = rqURL + '&boxever_version=' + boxever_version;\n\n\t\tif(typeof content_version != 'undefined')\n\t\t\trqURL = rqURL + '&content_version=' + content_version;\n\n        var callbackErrorHandling =\n\t\tbx.post(rqURL, data, function(data) {\n            try {\n                // The following occurs when the browser_id in the request is invalid\n                // {\"status\":\"NOT_FOUND\",\"error_msg\":\"Invalid browser id/ref specified\"}\n                if (\"NOT_FOUND\" === data.status && \"Invalid browser id/ref specified\" === data.error_msg) {\n                    // The browser id/ref is not valid so delete the cookie and wait for next page refresh to reset cookie\n                    var msg = \"Resetting cookie name for browser id/ref \" + bx.getID() + \" for client_key \" + bx.getClientKey();\n                    bx.resetCookieName();\n                    BoxeverJERS.errors.push(msg);\n                }\n            } catch (e) {\n            }\n            callback(data);\n        });\n\t}\n\n\tfunction createResource (resource, data, api_token, callback, format) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/create.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\t\trqURL = rqURL + '&';\n\t\trqURL = rqURL + 'api_token=' + api_token;\n\t\tbx.post(rqURL, data, callback);\n\t}\n\n\tfunction showResource(resource, ref, api_token, callback, format) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + ref;\n\t\trqURL = rqURL + '/show.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\t\trqURL = rqURL + '&';\n\t\trqURL = rqURL + 'api_token=' + api_token;\n\t\tbx.get(rqURL, callback);\n\t}\n\n\tfunction searchResource(resource, data, api_token, callback, format) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/search.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\t\trqURL = rqURL + '&';\n\t\trqURL = rqURL + 'api_token=' + api_token;\n\t\tif (data !== null && data.indexOf('=') > 0){\n\t\t\tvar firstEqual = data.indexOf('=');\n\t\t\tvar name = encodeURIComponent(data.substring(0, firstEqual));\n\t\t\t// Don't substring firstEqual+1 to handle = being the last character\n\t\t\t// Only replace the first one so people can put '=' in the parameter value...\n\t\t\tvar value = encodeURIComponent(data.substring(firstEqual).replace('=',''));\n\t\t\trqURL = rqURL + '&';\n\t\t\trqURL = rqURL + name + '=' + value;\n\t\t}\n\t\tbx.get(rqURL, callback);\n\t}\n\n\tfunction updateResource(resource, ref, data, api_token, callback, format) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + ref;\n\t\trqURL = rqURL + '/update.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\t\trqURL = rqURL + '&';\n\t\trqURL = rqURL + 'api_token=' + api_token;\n\t\tbx.post(rqURL, data, callback);\n\t}\n\n\tfunction deleteResource(resource, ref, entity, api_token, callback, format) {\n\t\tvar rqURL = bx.getTarget();\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + ref;\n\t\tif (entity !== null && entity.length > 0) {\n\t\t\trqURL = rqURL + '/' + encodeURIComponent(entity);\n\t\t}\n\t\trqURL = rqURL + '/delete.';\n\t\trqURL = rqURL + format;\n\t\trqURL = rqURL + '?';\n\t\trqURL = rqURL + 'client_key=' + bx.getClientKey();\n\t\trqURL = rqURL + '&';\n\t\trqURL = rqURL + 'api_token=' + api_token;\n\t\tbx.get(rqURL, callback);\n\t}\n\n\t// //////////////////////// PUBLIC METHODS ////////////////////////\n\n\t// --------------------------------\n\t// Ping 1.2 API: Create\n\t// --------------------------------\n\tbx.pingCreate = function(data, callback, format) {\n\t\tcreateResourcePublic('ping', data, callback, format);\n\t};\n\n\t// --------------------------------\n\t// Event 1.2 API: Create, Show, Search\n\t// --------------------------------\n\tbx.eventCreate = function(data, callback, format) {\n\t\tcreateResourcePublic('event', data, callback, format, \"1.3.2\", typeof _boxever_content_version != 'undefined'? _boxever_content_version: undefined);\n\t};\n\tbx.eventShow = function(ref, api_token, callback, format) {\n\t\tshowResource('event', ref, api_token, callback, format);\n\t};\n\tbx.eventSearch = function(data, api_token, callback, format) {\n\t\tsearchResource('event', data, api_token, callback, format);\n\t};\n\n    // --------------------------------\n    // Browser 1.2 API - Create used to establish browser identity for visiting client, Show to see the mapping\n    // --------------------------------\n    bx.browserCreate = function (data, callback, format) {\n       createResourcePublic('browser', data, callback, format);\n    };\n\n    bx.browserShow = function (ref, api_token, callback, format) {\n    \tshowResource('browser', ref, api_token, callback, format);\n    };\n\n\t// --------------------------------\n\t// Customer 1.2 API: Create, Show, Update, Delete, Search\n\t// --------------------------------\n\tbx.customerCreate = function(data, api_token, callback, format) {\n\t\tcreateResource('customer', data, api_token, callback, format);\n\t};\n\tbx.customerShow = function(ref, api_token, callback, format) {\n\t\tshowResource('customer', ref, api_token, callback, format);\n\t};\n\tbx.customerUpdate = function(ref, data, api_token, callback, format) {\n\t\tupdateResource('customer', ref, data, api_token, callback, format);\n\t};\n\tbx.customerDelete = function(ref, entity, api_token, callback, format) {\n\t\tdeleteResource('customer', ref, entity, api_token, callback, format);\n\t};\n\tbx.customerSearch = function(data, api_token, callback, format) {\n\t\tsearchResource('customer', data, api_token, callback, format);\n\t};\n\n\t// --------------------------------\n\t// Customerdata 1.2 API: Create, Show, Update, Delete\n\t// --------------------------------\n\tbx.customerDataCreate = function(data, api_token, callback, format) {\n\t\tcreateResource('customerdata', data, api_token, callback, format);\n\t};\n\tbx.customerDataShow = function(ref, api_token, callback, format) {\n\t\tshowResource('customerdata', ref, api_token, callback, format);\n\t};\n\tbx.customerDataUpdate = function(ref, data, api_token, callback, format) {\n\t\tupdateResource('customerdata', ref, data, api_token, callback, format);\n\t};\n\tbx.customerDataDelete = function(ref, entity, api_token, callback, format) {\n\t\tdeleteResource('customerdata', ref, entity, api_token, callback, format);\n\t};\n\n\t// --------------------------------\n\t// Campaign 1.2 API: Create, Show\n\t// --------------------------------\n\tbx.campaignCreate = function(data, callback, format) {\n\t\tcreateResourcePublic('campaign', data, callback, format);\n\t};\n\tbx.campaignShow = function(data, callback, format) {\n\t\tshowResource('campaign', ref, api_token, callback, format);\n\t};\n\tbx.campaignSearch = function(data, api_token, callback, format) {\n\t\tsearchResource('campaign', data, api_token, callback, format);\n\t};\n\n\t// --------------------------------\n\t// Audit 1.2 API: Show, Search\n\t// --------------------------------\n\tbx.auditShow = function(ref, api_token, callback, format) {\n\t\tshowResource('audit', ref, api_token, callback, format);\n\t};\n\tbx.auditSearch = function(data, api_token, callback, format) {\n\t\tsearchResource('audit', data, api_token, callback, format);\n\t};\n\n\t// --------------------------------\n\t// Profile 1.2 API: Create, Show, Update, Search\n\t// --------------------------------\n\tbx.profileCreate = function(data, api_token, callback, format) {\n\t\tcreateResourcePublic('profile', data, callback, format);\n\t};\n\tbx.profileShow = function(ref, api_token, callback, format) {\n\t\tshowResource('profile', ref, api_token, callback, format);\n\t};\n\tbx.profileUpdate = function(data, ref, api_token, callback, format) {\n\t\tupdateResource('profile', ref, data, api_token, callback, format);\n\t};\n\tbx.profileSearch = function(data, api_token, callback, format) {\n\t\tsearchResource('profile', data, api_token, callback, format);\n\t};\n\n}(Boxever));\n// Extend With API 2 Functions\n/*\n * ----------------------------- Boxever_API_2 -------------------------------------\n *\n * Dependencies: Boxever's boxever_api_core.js\n */\n(function(bx) {\n\n\t// //////////////////////// PRIVATE METHODS ////////////////////////\n\n\tfunction createV2ResourcePublic (resource, data, callback) {\n\t\tvar rqURL = bx.getTarget('2');\n\t\trqURL = rqURL + '/';\n\t\trqURL = rqURL + resource;\n\n\t\tbx.post(rqURL, data, callback);\n\t}\n\n\t// //////////////////////// PUBLIC METHODS ////////////////////////\n\t// --------------------------------\n\t// FlowExecution 2 API: Create\n\t// --------------------------------\n\tbx.flowExecutionCreate = function(data, callback) {\n\t\tcreateV2ResourcePublic('flowExecutions', data, callback);\n    };\n    // --------------------------------\n\t// Engage 2 API\n\t// --------------------------------\n\tbx.callFlows = function(data, callback) {\n\t\tcreateV2ResourcePublic('callFlows', data, callback);\n\t};\n\n}(Boxever));\n//Legacy Declaration\nvar _boxever = Boxever;\n\n_boxever.init();\n"]},"metadata":{},"sourceType":"module"}